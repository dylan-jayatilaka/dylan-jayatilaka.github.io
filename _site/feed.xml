<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom" xml:lang="en">



  
  

<title type="text">That Blog by Dylan</title>
<generator uri="https://github.com/mojombo/jekyll">Jekyll</generator>
<link rel="self" type="application/atom+xml" href="http://localhost:4000/feed.xml" />
<link rel="alternate" type="text/html" href="http://localhost:4000/" />
<updated>2014-10-07T09:46:38+08:00</updated>
<id>http://localhost:4000/</id>
<author>
  <name>Dylan Jayatilaka</name>
  <uri>http://localhost:4000/</uri>
  <email>dylan.jayatilaka@gmail.com</email>
</author>


<entry>
  <title type="html"><![CDATA[Particles in boxes]]></title>
  <link rel="alternate" type="text/html" href="http://localhost:4000/articles/particles-in-boxes/"/>
  <id>http://localhost:4000/articles/particles-in-boxes</id>
  <updated>2014-09-21T00:00:00-00:00</updated>
  <published>2014-09-21T00:00:00+08:00</published>
  
  <author>
    <name>Dylan Jayatilaka</name>
    <uri>http://localhost:4000</uri>
    <email>dylan.jayatilaka@gmail.com</email>
  </author>
  <category scheme="http://localhost:4000/tags/#chem2002" term="chem2002" /><category scheme="http://localhost:4000/tags/#schrodinger%20equation" term="schrodinger equation" /><category scheme="http://localhost:4000/tags/#particle%20in%20a%20box" term="particle in a box" />
  <content type="html">
  
    &lt;p&gt;This is a post for my second year Phys Chem students but it may have
tidbits of interest to others.&lt;/p&gt;

&lt;p&gt;Particle-in-a-box models are great for seeing how quantum works.&lt;/p&gt;

&lt;p&gt;Particle-in-a-box models are not just toy models, either. For example:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;
    &lt;p&gt;The images above show the probability density waves of a surface electron
trapped in a “ring” of iron atoms placed on a copper surface by &lt;a href=&quot;http://en.wikipedia.org/wiki/Scanning_tunneling_microscope&quot;&gt;scanning
tunneling microscopy (STM)&lt;/a&gt;.
The shapes of these waves are well modelled by an electron trapped in a
disk-shaped box.&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;The particle-on-a-ring model has also been used by my colleague
Pierre-Francois Loos to develop &lt;a href=&quot;http://arxiv.org/abs/1302.6661&quot;&gt;insight into electron correlation&lt;/a&gt;.&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;Later in this post I will show how such models can be used to calculate
conduction of an electron “through” a series of barriers e.g. for
designing nanoelectronic devices.&lt;/p&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;for-students&quot;&gt;For students&lt;/h2&gt;

&lt;p&gt;To understand these notes you need to&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;
    &lt;p&gt;Know basic calculus (derivatives and integrals) and you need to understand
the basics of complex numbers. If you do not, bail out here, and come back
after you know.&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;Second, you should read the previous &lt;a href=&quot;http://dylan-jayatilaka.net/articles/super-quick-summary-of-qm/&quot;&gt;super quick intro to quantum
mechanics&lt;/a&gt;&lt;/p&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Scattered through this and the previous post are some questions. Carefully
study these questions and their answers. The exam questions will be very
similar, if not identical.&lt;/p&gt;

&lt;p&gt;The later material on transmission through multiple barriers is not
examinable. I present it because it could be useful if you are interested
in, for example, modelling energy levels and conduction through molecules
(Prof. George Koutsantonis is interested in making such “molecular wires”).&lt;/p&gt;

&lt;h2 id=&quot;what-is-a-particle-in-a-box-problem&quot;&gt;What is a particle-in-a-box problem?&lt;/h2&gt;

&lt;p&gt;Particle in a box problems are those for a single particle moving
in one dimension subject to a piecewise constant potential energy i.e.
a potential energy that looks like the following function:&lt;/p&gt;

&lt;figure&gt;
   &lt;img src=&quot;/images/piecewise-constant-potential.jpg&quot; /&gt;
&lt;/figure&gt;

&lt;p&gt;From looking at this picture you can see that the particle experiences
different “constant” energies at different points along the axis. In fact,
if we wanted to write this potential in “maths” it would be this:&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;% &lt;![CDATA[

V(x) =
\left\{
\begin{array}{cl}
V_0 &amp; \textrm{for } x&lt;x_1     \\
V_1 &amp; \textrm{for } x_1&lt;x&lt;x_2 \\
V_2 &amp; \textrm{for } x&gt;x_2
\end{array}
\right.
 %]]&gt;&lt;/script&gt;

&lt;p&gt;In this case the article seems to encounter a kind of “step barrier”.
Of course, other shapes for \( V(x) \) are possible and each leads
to a different problem.&lt;/p&gt;

&lt;h2 id=&quot;strategy-for-solving-particle-in-a-box-problems&quot;&gt;Strategy for solving particle-in-a-box problems&lt;/h2&gt;

&lt;p&gt;The strategy for solving these one dimensional problems is always the same:&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;
    &lt;p&gt;Write down the
&lt;a href=&quot;http://en.wikipedia.org/wiki/Hamiltonian_(quantum_mechanics)#The_Schr.C3.B6dinger_Hamiltonian&quot;&gt;Hamiltonian&lt;/a&gt;
for the problem,&lt;/p&gt;

    &lt;script type=&quot;math/tex; mode=display&quot;&gt;
\boxed{
\hat{H} = -\displaystyle\frac{\hbar^2}{2m} \frac{d^2}{dx^2} + V(x)
}
&lt;/script&gt;

    &lt;p&gt;and hence the Schrodinger equation \( \hat{H}\psi = E\psi \) for the
unknown energies \( E \) and unknown wavefunctions \( \psi \).&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;Write down the general solution in each region where the potential is
constant. The general solutions in each region is &lt;em&gt;always&lt;/em&gt; of the
form \( \psi(x) = A e^{B x}\) where \( A \) and \(B\) are
(possibly complex) unknown constants to be found. To save time you can
learn these possible cases to be applied in different regions where
the potential is constant:&lt;/p&gt;

    &lt;ul&gt;
      &lt;li&gt;
        &lt;p&gt;\( \boxed{\psi(x) = A e^{i k x}} \) for free or unbound particles.&lt;/p&gt;

        &lt;ul&gt;
          &lt;li&gt;
            &lt;p&gt;A free particle is one where \( V(x) = 0 \).&lt;/p&gt;
          &lt;/li&gt;
          &lt;li&gt;
            &lt;p&gt;An unbound particle has energy \( E \) greater than the
largest value of the potential \( V(x) \) for any \( x \)
i.e. the particle has enough energy to overcome any barrier.&lt;/p&gt;
          &lt;/li&gt;
          &lt;li&gt;
            &lt;p&gt;A free particle is unbound, but an unbound particle is not
necessarily free.&lt;/p&gt;
          &lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
      &lt;li&gt;
        &lt;p&gt;\( \boxed{\psi(x) = A e^{-\alpha x} + B e^{+\beta x}} \)
for electrons in a region where the energy of the particle \( E \)
is &lt;em&gt;less&lt;/em&gt; than the value of the potential. This is called an
exponential decay region or barrier-penetration region of the wavefunction.&lt;/p&gt;
      &lt;/li&gt;
      &lt;li&gt;
        &lt;p&gt;\( \boxed{\psi(x) = A \sin kx + B \cos kx} \)
for electrons where the energy of the particle \( E \)
is &lt;em&gt;greater&lt;/em&gt; than the value of the potential. This is called
an oscillatory region of the wavefunction.&lt;/p&gt;
      &lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;Find the unknown constants in the wavefunction(s) by making sure that
the solutions are continuous and smooth - see Rule 1 of quantum mechanics in
the &lt;a href=&quot;http://dylan-jayatilaka.net/articles/super-quick-summary-of-qm/`&quot;&gt;previous post&lt;/a&gt;.
At the end of the problem there will usually only one unknown constant left
which can be found by the normalization condition if needed.&lt;/p&gt;
  &lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;A pretty good graphic for illustrating this procedure is shown at the
&lt;a href=&quot;http://hyperphysics.phy-astr.gsu.edu/hbase/quantum/pfbox.html&quot;&gt;hyperphysics site here&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Q9&lt;/strong&gt;. &lt;em&gt;What is the basic strategy for solving particle in a box problems?
You do not need to list the possible general solutions for each case&lt;/em&gt;.&lt;/p&gt;

&lt;p&gt;&lt;em&gt;Answer&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;Write down the Schrodinger equation. Write down the general solutions to the
Schrodinger equation in each region where the potential is constant. Find the
unknown constants in the different pieces of the wavefunction for each region
by makeing sure that it is continuous and smooth.&lt;/p&gt;

&lt;h2 id=&quot;free-electron-in-one-dimension---otherwise-known-as-the-particle-not-in-a-box&quot;&gt;Free electron in one dimension - otherwise known as the particle &lt;em&gt;not&lt;/em&gt; in a box&lt;/h2&gt;

&lt;p&gt;Now we get to the meat. Note that the meat is not in a box.&lt;/p&gt;

&lt;figure&gt;
   &lt;img src=&quot;/images/meat-on-the-bone.jpg&quot; /&gt;
&lt;/figure&gt;

&lt;p&gt;&lt;strong&gt;Q10&lt;/strong&gt;. &lt;em&gt;Solve the Schrodinger equation for an electron moving freely in one dimension&lt;/em&gt;.&lt;/p&gt;

&lt;p&gt;&lt;em&gt;Strategy&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;The strategy for solving these problems was given above. The Schrodinger
equation for the free particle was written down in Q5 in the last post. Basically
a free particle means that \( V(x) = 0 \). But before applying the strategy
and solving the equation let’s think what answer we might expect. Actually,
since the electron can move freely, we would expect that it can have … any
energy it likes … as long as it is positive. Also, we expect that an electron
moving freely should be located … well, anywhere it likes … meaning to say
that the probability of finding it at any position is equally likely.&lt;/p&gt;

&lt;p&gt;&lt;em&gt;Answer&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;From Q5 the Schrodinger equation for the free electron is&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;
  -\frac{\hbar^2}{2m_e}\frac{d^2\psi}{dx^2} = E \psi
&lt;/script&gt;

&lt;p&gt;From the strategy we know a possible solution of this equation is
\( \psi(x) = A e^{i k x} \). Note that the constant \( i k \) is explicitly
complex, so that \( k \) is a real number. To find the unknown numbers
\( A \) and \(k \) we substitute this general form into the
left hand side of the equation and simplify:&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;% &lt;![CDATA[

\begin{align}
\textrm{LHS}
&amp; = -\frac{\hbar^2}{2 m_e} \frac{d^2}{dx^2} \psi(x) \\
&amp; = -\frac{\hbar^2}{2 m_e} \frac{d^2}{dx^2} A e^{i k x} \\
&amp; = -\frac{\hbar^2}{2 m_e} \frac{d}{dx} \frac{d}{dx} A e^{i k x} \\
&amp; = -\frac{\hbar^2}{2 m_e} \frac{d}{dx} A (ik) e^{i k x} \\
&amp; = -\frac{\hbar^2}{2 m_e} A (ik)^2 e^{i k x} \\
&amp; =  \frac{\hbar^2}{2 m_e} k^2 A e^{i k x} \\
&amp; =  \frac{\hbar^2 k^2}{2 m_e} \psi(x)
  =  E\, \psi(x)
\end{align}
 %]]&gt;&lt;/script&gt;

&lt;p&gt;This shows that \( \psi(x) = A e^{i k x} \) is indeed a solution of our
Schrodinger equation provided that&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;
E = \frac{\hbar^2 k^2}{2 m_e}.
&lt;/script&gt;

&lt;p&gt;Q9 is now solved!&lt;/p&gt;

&lt;p&gt;Note that, as we expected:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;
    &lt;p&gt;\( E \) is positive regardless of whether the arbitrary
constant \( k \) is positive or negative (since the square of an arbitrary
number is always positive).&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;The probability of fiding the electron an any position is
\( \psi^{\ast}(x) \psi(x) = A^{\ast} e^{-i k x} A e^{i k x} = |A|^2 \) and
does not depend on \( x \) i.e. the probability of finding
the particle at one place or another is the same i.e. the particle
is located everywhere with equal probability.&lt;/p&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;strong&gt;Q11&lt;/strong&gt;. 
&lt;em&gt;Show that the free electron wavefunction \( \psi = A e^{i k x} \) has momentum \( \hbar k \).
Show that the free electron wavefunction \( \psi = A e^{-i k x} \) has momentum \( -\hbar k \).
What is the meaning of these two wavefunctions?&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;&lt;em&gt;Strategy&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;According to the Rules of QM, a wavefunction has a certain momentum if it is an
eigenfunction of the corresponding operator. Hence we need to show that
\( \psi(x) \) is an eigenfunction of the momentum \( \hat{p} \).&lt;/p&gt;

&lt;p&gt;&lt;em&gt;Answer&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;We evaluate \( \hat{p}\psi(x) \) for the wavefunction in Q9:&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;% &lt;![CDATA[

\begin{align}
\hat{p} \psi(x) &amp; = -i \hbar \frac{d}{dx} A e^{i k x}  \\
                &amp; = -i \hbar (i k) A e^{i k x} \\
                &amp; = \hbar k \psi(x)
\end{align}
 %]]&gt;&lt;/script&gt;

&lt;p&gt;This is an eigenvalue equation with eigenvalue \( \hbar k \). Therefore the
momentum of a free electron with wave function \( \psi(x) = e^{i k x} \)
is \( \hbar k \).&lt;/p&gt;

&lt;p&gt;Likewise:&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;% &lt;![CDATA[

\begin{align}
\hat{p} \psi(x) &amp; = -i \hbar \frac{d}{dx} A e^{-i k x}  \\
                &amp; = -i \hbar (-i k) A e^{-i k x} \\
                &amp; = -\hbar k \psi(x)
\end{align}
 %]]&gt;&lt;/script&gt;

&lt;p&gt;This is an eigenvalue equation with eigenvalue \( -\hbar k \). Therefore the
momentum of a free electron with wave function \( \psi(x) = e^{-i k x} \)
is \( -\hbar k \).&lt;/p&gt;

&lt;p&gt;Clearly the wavefunction \( \psi(x) = A e^{i k x} \) corresponds
to an electron moving with positive momentum (i.e. moving to the right)
while \( \psi(x) = A e^{-i k x} \) corresponds to an electron with
negative momentum (i.e. moving to the left), assuming \( k&amp;gt;0 \).&lt;/p&gt;

&lt;p&gt;Note that the unknown constant \( A \) can not be determined by
the normalization condition: recall that according to the Rules
of QM, normalization only applies to bound states.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Q12&lt;/strong&gt;. &lt;em&gt;Show that the wavefunction \( \psi = A e^{i k x} + B e^{-i k x} \)
is also a solution to the free electron Schrodinger equation. Is this a
valid wavefunction?&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;&lt;em&gt;Strategy&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;Substitute this wavefunction into the free particle Schrodinger equation and see
if it is an eigenfunction i.e. see if it obeys \( \hat{H}\psi = E \psi \).&lt;/p&gt;

&lt;p&gt;&lt;em&gt;Answer&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;You can check that \( \psi(x) = B e^{-i k x} \) is a solution to the
same free electron Schrodinger equation by substitution. In fact, the algebra
is identical except that instead of \( k \) the opposite value \( -k \) is
used. Since both \( A e^{-i k x} \) and \( B e^{-i k x} \) are separately
solutions, their sum must also be i.e.&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;% &lt;![CDATA[

\begin{align}
\hat{H} \psi(x)
&amp; = \hat{H} \left( A e^{i k x} + B e^{-i k x} \right) \\
&amp; = \hat{H} A e^{i k x} + \hat{H} B e^{-i k x} \\
&amp; = E A e^{i k x} + E B e^{-i k x} \\
&amp; = E \left( A e^{i k x} + B e^{-i k x} \right) \\
&amp; = E \psi(x)
\end{align}
 %]]&gt;&lt;/script&gt;

&lt;p&gt;is &lt;em&gt;also&lt;/em&gt; a solution.&lt;/p&gt;

&lt;p&gt;Is this a valid solution? On the face of it, yes. However, you can show
the probability density for this wavefunction is&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;% &lt;![CDATA[

\begin{align}
\psi^\ast(x)\psi(x) &amp; = |A|^2 + |B|^2 + A^\ast B e^{-i 2 k x}  + B^\ast A e^{i 2 k x} \\
                    &amp; = |A|^2 + |B|^2 + 2 \textrm{Re} (B^\ast A) \cos 2 k x.
\end{align}
 %]]&gt;&lt;/script&gt;

&lt;p&gt;The last equality follows from noting that the cross terms are complex
conjugates. Therefore this wavefunction &lt;em&gt;does not have a constant probability
density&lt;/em&gt;. Perhaps it may not be an appropriate wavefunction -
though I have not given an explicit rule to forbid it.&lt;/p&gt;

&lt;p&gt;This question nevertheless illustrates an important point about quantum
mechanics: &lt;/p&gt;

&lt;p&gt;If we have more than one solution to the SChrodinger equation with
the &lt;em&gt;same&lt;/em&gt; energy, then we can take a linear combination of these solutions,
like above with arbitrary constants \( A \) and \( B \), and get a different
wavefunction with the energy! There are an inifinite number of such wavefunctions
corresponding to the same energy - just choose different arbitrary constants. 
This is the idea behind
&lt;a href=&quot;http://en.wikipedia.org/wiki/Orbital_hybridisation&quot;&gt;hybrid atomic orbitals&lt;/a&gt;
in the valence bond theory of chemical bonding. In the hybrid atomic orbital
theory, linear combinations of wavefunctions of equal or nearly equal energy,
like the s and p orbitals, are used to explain how atomic orbitals adjust themselves
to maximize the bonding to &lt;em&gt;neighbouring&lt;/em&gt; atoms around a central atom.&lt;/p&gt;

&lt;h2 id=&quot;particle-in-a-box&quot;&gt;Particle in a box&lt;/h2&gt;

&lt;p&gt;&lt;strong&gt;Q13&lt;/strong&gt;. &lt;em&gt;Solve the Schrodinger equation for an electron in a box of length
\( L \) which starts at the origin (the potential is infinite outside the box)&lt;/em&gt;.&lt;/p&gt;

&lt;p&gt;&lt;em&gt;Strategy&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;Draw a picture and apply the given strategy above. Note that the the
wavefunction \( \psi(x) = 0 \) outside the box; if not we would get infinity
appearing in the equation \( \hat{H}\psi(x) = E\psi(x) \) when \(x \) is
outside the box.&lt;/p&gt;

&lt;p&gt;&lt;em&gt;Answer&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;The potential \( V(x) \) looks as shown below. Also shown are the solutions
which we have yet to find.&lt;/p&gt;

&lt;figure&gt;
   &lt;img src=&quot;/images/p-in-infinite-box.jpg&quot; /&gt;
&lt;/figure&gt;

&lt;p&gt;According to the strategy we should try wavefunctions of the form
\( \psi(x) = A \sin k x + B \cos k x \). Substituting in the Schrodinger
equation we get&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;% &lt;![CDATA[

\begin{align}
\textrm{LHS}
&amp; = -\frac{\hbar^2}{2 m_e} \frac{d^2}{dx^2} \psi(x) \\
&amp; = -\frac{\hbar^2}{2 m_e} \frac{d^2}{dx^2} \left( A \sin kx + B \cos kx \right) \\
&amp; = -\frac{\hbar^2}{2 m_e} \frac{d}{dx} \frac{d}{dx} \left( A \sin kx + B \cos kx \right) \\
&amp; = -\frac{\hbar^2}{2 m_e} \frac{d}{dx} \left(A k \cos kx - B k \sin kx \right) \\
&amp; = -\frac{\hbar^2}{2 m_e} \left(-A k^2 \sin kx - B k^2 \cos kx \right) \\
&amp; =  \frac{\hbar^2}{2 m_e} k^2 \left(A \sin kx + B \cos kx \right) \\
&amp; =  \frac{\hbar^2 k^2}{2 m_e} \psi(x)
  =  E\, \psi(x)
\end{align}
 %]]&gt;&lt;/script&gt;

&lt;p&gt;So as before we see that \( \psi(x) = A \sin k x + B \cos k x \) is a solution
of the Schrodinger equation with&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;
E = \frac{\hbar^2 k^2}{2 m_e}.
&lt;/script&gt;

&lt;p&gt;In fact this solution would be acceptable as an answer to the “free particle”
problem. The difference is now that we have to apply the boundary conditions on
the wavefunction, which are from the picture:&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;% &lt;![CDATA[

\begin{align}
\psi(0) &amp; = 0 \ \ \subnote{at $x = 0$}\\
\psi(L) &amp; = 0 \ \ \subnote{at $x = L$}
\end{align}
 %]]&gt;&lt;/script&gt;

&lt;ul&gt;
  &lt;li&gt;
    &lt;p&gt;Substituting \( \psi(x) \) in the first equation above determines the value
of the unknown constant \( B \) as follows:&lt;/p&gt;

    &lt;script type=&quot;math/tex; mode=display&quot;&gt;% &lt;![CDATA[

\begin{align}
\psi(0) &amp; = A \sin k 0 + B \cos k 0 \\
        &amp; = A \sin 0 + B \cos 0 \\
        &amp; = A \times 0 + B \times 1 \\
        &amp; = B \\
        &amp; = 0
\end{align}
 %]]&gt;&lt;/script&gt;

    &lt;p&gt;Here we used the standard values of \( \sin 0 = 0 \) and \( \cos 0 = 1 \).
Therefore we have figured out that \( \psi(x) = A \sin k x \).&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;Now we apply the second boundary condition and see what we get:&lt;/p&gt;

    &lt;script type=&quot;math/tex; mode=display&quot;&gt;% &lt;![CDATA[

\begin{align}
\psi(L) &amp; = A \sin k L \\
        &amp; = \sin k L \\
        &amp; = 0
\end{align}
 %]]&gt;&lt;/script&gt;

    &lt;p&gt;This equation has solutions only when the angle \( k L = n \pi \) radians where
\( n = 1, 2, \ldots \). Note that the value \( n = 0 \) leads to a a wavefunction
\( \psi(x) = 0 \) which has no area underneath it i.e. it is unnormalizable and therefore
doesn’t obey the rules for an allowed wavefunction. Likewise although
\( n = -1, -2, -3, \ldots \) are also solutions of the above equation, they
do not lead to different wavefunction solutions since
\( \psi(x) = \sin kx = \sin (-kx) \) due to the properties of the sine function.&lt;/p&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;The last boundary condition equation gives a value for the unknown \( k \)
constant which means it determines the allowed energy eigenvalues:&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;
E = \frac{\hbar^2 k^2}{2 m_e}
  = \frac{\hbar^2}{2 m_e}\frac{(n\pi)^2}{L^2}, \ \ n = 1, 2, 3, \ldots
&lt;/script&gt;

&lt;p&gt;Corresponding to wavefunction \( \psi(x) = A \sin \displaystyle\frac{n \pi}{L} x \).&lt;/p&gt;

&lt;p&gt;To find the unknown constant \( A \) we must normalize the wavefunction,&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;
\int_0^L \psi^\ast(x) \psi(x) dx
  = \int_0^L A^2 \sin^2 \frac{n\pi}{L} x
  = 1
&lt;/script&gt;

&lt;p&gt;From which we get:&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;
A  = \left( \int_0^L \sin^2 \frac{n\pi}{L} x \right)^{1/2}
&lt;/script&gt;

&lt;p&gt;We can evaluate this integral by looking up tables if we like.
The important thing is not the answer but &lt;em&gt;how&lt;/em&gt; to get it.&lt;/p&gt;

&lt;h2 id=&quot;particle-in-a-half-infinite-box&quot;&gt;Particle in a half infinite box&lt;/h2&gt;

&lt;p&gt;&lt;strong&gt;Q14&lt;/strong&gt;. &lt;em&gt;Solve the Schrodinger equation for an electron in a box of length
\( L \) which starts at the origin. The potential is infinite to the left
of the box, and has a given value \( V_0 \) to the right. The energy of the
electron is less than \( V_0 \)&lt;/em&gt;.&lt;/p&gt;

&lt;p&gt;&lt;em&gt;Strategy&lt;/em&gt;.&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;First draw a picture of the potential. It looks similar like the previous
question, except that to the right, the height of the box is \( V_0 \) and
not infinite.&lt;/li&gt;
  &lt;li&gt;The wavefunction to the left of the box is zero as explained in the previous
question.&lt;/li&gt;
  &lt;li&gt;There are two other wavefunctions \(\psi\sub\s{in} \) and
\(\psi\sub\s{out}\) for the inside and outside (right) of the box
respectively. These two wavefunctions need to be “joined” at the boundary to
make a “smooth” wavefunction.&lt;/li&gt;
  &lt;li&gt;Inside the box, the wavefunction is the same as before,
\( \psi\sub\s{in}(x) = A \sin k x \). This satisfies the boundary
condition \( \psi\sub{in}(0) = 0 \).&lt;/li&gt;
  &lt;li&gt;Outside the box, according to strategy above, the wavefunction outside the
box is \( \psi\sub\s{out}(x) = B e^{-\beta x} + C e^{\beta x} \). However
the part \( C e^{\beta x } \) gets bigger as \(x \) gets larger and so if
constant \( C \) is not zero the wavefunction would have an infinite area
underneath it i.e. it would be unnormalizable. Therefore the wavefunction
outside the box is \( \psi\sub\s{out}(x) = B e^{-\beta x} \).&lt;/li&gt;
  &lt;li&gt;Finally, we substitute \(\psi\sub\s{in}\) and \(\psi\sub\s{out}\) into
the Schrodinger equation and apply the boundary conditions to get the answer.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;em&gt;Answer&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;Here is the picture of the potential:&lt;/p&gt;

&lt;figure&gt;
   &lt;img src=&quot;/images/p-in-half-infinite-box.jpg&quot; /&gt;
&lt;/figure&gt;

&lt;p&gt;Now let’s substitute in our general solutions for each region.&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;
    &lt;p&gt;Exactly as before, we substitute \( \psi\sub\s{in}(x) = A \sin k x \)
into the Schrodinger equation to get&lt;/p&gt;

    &lt;script type=&quot;math/tex; mode=display&quot;&gt;
E = \frac{\hbar^2 k^2}{2 m_e}      \ \ \subnote{inside the box}.
&lt;/script&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;Outside the box i.e. for \( 0 &amp;lt; x &amp;lt; L \) we have a slightly different
Schrodinger equation:&lt;/p&gt;

    &lt;script type=&quot;math/tex; mode=display&quot;&gt;
\hat{H}\psi\sub\s{out}(x)
= \left[ -\frac{\hbar^2}{2 m_e}\frac{d^2}{dx^2} + V_0\right] \psi\sub\s{out}(x)
= E\, \psi\sub\s{out}(x)
&lt;/script&gt;

    &lt;p&gt;From the above equation we can see that we need a second
derivative of \( \psi\sub\s{out}(x) = B e^{-\beta x} \), so lets
do that:&lt;/p&gt;

    &lt;script type=&quot;math/tex; mode=display&quot;&gt;% &lt;![CDATA[

\begin{align}
-\frac{\hbar^2}{2 m_e} \frac{d^2}{dx^2} \psi\sub\s{out}(x)
&amp; = -\frac{\hbar^2}{2 m_e} \frac{d^2}{dx^2} \left( B e^{-\beta x} \right) \\
&amp; = -\frac{\hbar^2}{2 m_e} \frac{d}{dx} \frac{d}{dx} \left( B e^{-\beta x} \right) \\
&amp; = -\frac{\hbar^2}{2 m_e} \frac{d}{dx} \left(B (-\beta) e^{-\beta x} \right) \\
&amp; = -\frac{\hbar^2}{2 m_e} \left(B (-\beta)^2 e^{-\beta x}\right) \\
&amp; = -\frac{\hbar^2}{2 m_e} \beta^2 \left( B e^{-\beta x} \right) \\
&amp; = -\frac{\hbar^2 \beta^2}{2 m_e} \psi\sub\s{out}(x)
\end{align}
 %]]&gt;&lt;/script&gt;

    &lt;p&gt;Using this result, the Schrodinger equation outside the box becomes:&lt;/p&gt;

    &lt;script type=&quot;math/tex; mode=display&quot;&gt;% &lt;![CDATA[

\begin{align}
\hat{H}\psi\sub\s{out}(x)
&amp; = \left[ -\frac{\hbar^2}{2 m_e} \frac{d^2}{dx^2} + V_0 \right] \psi\sub\s{out}(x) \\
&amp; = \left[ -\frac{\hbar^2 \beta^2}{2 m_e}         + V_0 \right] \psi\sub\s{out}(x) \\
&amp; = E\,\psi\sub\s{out}(x).
\end{align}
 %]]&gt;&lt;/script&gt;

    &lt;p&gt;So we get &lt;em&gt;another&lt;/em&gt; equation for the energy,&lt;/p&gt;

    &lt;script type=&quot;math/tex; mode=display&quot;&gt;
E = -\frac{\hbar^2 \beta^2}{2 m_e} + V_0 \ \ \subnote{outside the box}
&lt;/script&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Now we can equate our two energy formula (the one inside the
box and the one outside the box) to get an expression
for \( \beta \) in terms of \( E \), and hence \( k \)
like this:&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;% &lt;![CDATA[

\begin{align}
E                              &amp; = -\frac{\hbar^2 \beta^2}{2 m_e} + V_0 \\
\frac{\hbar^2 \beta^2}{2 m_e} &amp; = V_0 - E \\
\beta^2                       &amp; = \frac{2 m_e}{\hbar^2} (V_0-E) \\
\beta                         &amp; = \left( \frac{2 m_e}{\hbar^2} (V_0-E) \right)^{1/2} \\
\beta                         &amp; = \left( \frac{2 m_e V_0}{\hbar^2} - k^2 \right)^{1/2}
\ \ \ \twonote{Using formula for $E$}{inside the box} \\
\end{align}
 %]]&gt;&lt;/script&gt;

&lt;p&gt;This shows that \( \beta \) is determined in terms of the unknown
constant \( k \).&lt;/p&gt;

&lt;p&gt;Now we need to apply the boundary conditions, which are:&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;% &lt;![CDATA[

\begin{align}
\psi\sub\s{in}(L)            &amp; = \psi\sub\s{out}(L) \\
\frac{\psi\sub\s{in}}{dx}(L) &amp; = \frac{\psi\sub\s{out}}{dx}(L).
\end{align}
 %]]&gt;&lt;/script&gt;

&lt;p&gt;The first condition ensures that the wavefunctions are “unbroken” or “continuous”.
The second condition ensures that the derivatives of the two wavefunction
match so the join is “smooth”. &lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;
    &lt;p&gt;The first condition gives&lt;/p&gt;

    &lt;script type=&quot;math/tex; mode=display&quot;&gt;
A \sin k L = B e^{-\beta L}
&lt;/script&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;The second condition gives&lt;/p&gt;

    &lt;script type=&quot;math/tex; mode=display&quot;&gt;
A k \cos k L = -B \beta e^{-\beta L}
&lt;/script&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;We can eliminate the constants \( A \) and \( B \) by dividing the second
equation by the first. The result is:&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;% &lt;![CDATA[

\begin{align}
\frac{k \cos k L}{\sin kL} &amp; = -\beta, \ \textrm{or} \\
k \cot k L                 &amp; = -\left( \frac{2 m_e V_0}{\hbar^2} - k^2 \right)^{1/2}
\end{align}
 %]]&gt;&lt;/script&gt;

&lt;p&gt;This is a difficult equation to solve. In general it has to be solved
numerically once we are given a value for \( V_0 \). Before choosing
a value let’s simplify the problem a bit by using atomic units i.e. units
where we set \( \hbar = m_e = 1 \). Atomic units are widely
used in quantum chemistry. Let’s further assume that \( L = 1 \) in
these units. Then our equation becomes:&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;
k \cot k = -\left( 2 V_0 - k^2 \right)^{1/2}
&lt;/script&gt;

&lt;p&gt;All we need now is a value of \( V_0 \). Let’s take
\( V_0 = 18 \). We can now solve this equation numerically.&lt;/p&gt;

&lt;p&gt;The easiest way to do it, go to the 
&lt;a href=&quot;http://www.wolframalpha.com/&quot;&gt;Wolfram Alpha&lt;/a&gt; web site and
type in \( \texttt{k cot k = -(36 - k^2)^(1/2)} \). You will get two
solutions: \( k = 2.679, 5.226 \). Cool!&lt;/p&gt;

&lt;p&gt;What about if \( V_0 \) is very large? Don’t we expect to get
something close to the particle-in-an-infinite-box problem?&lt;/p&gt;

&lt;p&gt;Let’s check. Choose \( V_0 = 500 \) and type into
&lt;a href=&quot;http://www.wolframalpha.com/&quot;&gt;Wolfram Alpha&lt;/a&gt;
\( \texttt{k cot k = -(1000 - k^2)^(1/2)} \). You
should get the results \( k = 3.05, 6.09, 12.17 \ldots \).
These values are indeed close to the solutions
\( k = \pi, 2\pi, 3\pi, \ldots \). Everything seems to
make sense!&lt;/p&gt;

&lt;h2 id=&quot;congratulations&quot;&gt;Congratulations&lt;/h2&gt;

&lt;p&gt;If you’ve got this far then congratulations! You understand the basics of
quantum mechanics.&lt;/p&gt;

&lt;h2 id=&quot;the-general-problem&quot;&gt;The general problem&lt;/h2&gt;


  
  &lt;p&gt;&lt;a href=&quot;http://localhost:4000/articles/particles-in-boxes/&quot;&gt;Particles in boxes&lt;/a&gt; was originally published by Dylan Jayatilaka at &lt;a href=&quot;http://localhost:4000&quot;&gt;That Blog by Dylan&lt;/a&gt; on September 21, 2014.&lt;/p&gt;</content>
</entry>


<entry>
  <title type="html"><![CDATA[Super quick summary of Quantum Mechanics]]></title>
  <link rel="alternate" type="text/html" href="http://localhost:4000/articles/super-quick-summary-of-qm/"/>
  <id>http://localhost:4000/articles/super-quick-summary-of-qm</id>
  <updated>2014-09-21T00:00:00-00:00</updated>
  <published>2014-09-20T00:00:00+08:00</published>
  
  <author>
    <name>Dylan Jayatilaka</name>
    <uri>http://localhost:4000</uri>
    <email>dylan.jayatilaka@gmail.com</email>
  </author>
  <category scheme="http://localhost:4000/tags/#chem2002" term="chem2002" /><category scheme="http://localhost:4000/tags/#quantum%20mechanics" term="quantum mechanics" /><category scheme="http://localhost:4000/tags/#wavefunctions" term="wavefunctions" /><category scheme="http://localhost:4000/tags/#operators" term="operators" /><category scheme="http://localhost:4000/tags/#measurement" term="measurement" /><category scheme="http://localhost:4000/tags/#eigenvalues" term="eigenvalues" />
  <content type="html">
  
    &lt;p&gt;This is a post for my second year Phys Chem students.&lt;/p&gt;

&lt;p&gt;The purpose of this post is to write down briefly the main ideas and Rules of
Quantum mechanics.&lt;/p&gt;

&lt;figure&gt;
   &lt;img src=&quot;/images/rembrandt-moses-with-the-ten-commandments.jpg&quot; /&gt;
&lt;/figure&gt;

&lt;p&gt;Quantum mechanics is hard for two reasons. First, the ideas are strange.
Second, it involves mathematics which is probably new to you. The double
whammy is a killer.&lt;/p&gt;

&lt;p&gt;Still, some of you may find quantum mechanics intruiguing. You would not be
alone. People still 
&lt;a href=&quot;http://dylan-jayatilaka.net/articles/quantum-theory-is-wrong/&quot;&gt;argue about it&lt;/a&gt;
even after a hundred years.&lt;/p&gt;

&lt;h2 id=&quot;why&quot;&gt;Why?&lt;/h2&gt;

&lt;p&gt;A common question that is encountered is “Why do I need to know about QM?” or
more briefly “So what?”.&lt;/p&gt;

&lt;p&gt;Here is the answer for chemists.&lt;/p&gt;

&lt;p&gt;You need to understand how quantum mechanics works because quantum
mechanics allows you to calculate everything about chemistry
(molecular properties, reaction rates) from equations &lt;a href=&quot;http://www.brainyquote.com/quotes/quotes/p/pauldirac279318.html&quot;&gt;without having to do
experiments&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;That’s big.&lt;/p&gt;

&lt;p&gt;In my opinion, these days, every organic chemist should do a simple QM
calculation to test out assumptions about their reaction scheme sites before
going into the lab for some pain. Of course, these QM calcs are done on a
computer - not with pen and paper. So you could just learn to use the
program. But in that case you would have no idea how the calculations work i.e.
you will be just a monkey. No-one wants to employ a monkey.&lt;/p&gt;

&lt;figure&gt;
   &lt;img src=&quot;/images/thoughtful-bonobo.jpg&quot; /&gt;
&lt;/figure&gt;

&lt;p&gt;Now I know you probably have not seen quantum mechanics before. Probably
you are freaking out. I want to say: Don’t Worry. QM is hard - but not &lt;em&gt;that&lt;/em&gt; hard.
Just remember: contrary to what you might have thought, you don’t yet know
everything. You have to learn more. It’s normal to feel that way with new
stuff. So relax. Afterwards, see if you can follow the questions and answers
below. If you’re still confused come and see me.&lt;/p&gt;

&lt;p&gt;Let’s get started.&lt;/p&gt;

&lt;h2 id=&quot;the-hyperphysics-web-site&quot;&gt;The hyperphysics web site&lt;/h2&gt;

&lt;p&gt;A really great web site which takes the standard historical story of QM and
uses the concept-map idea - and incidentally covers nearly exactly the same
material as our Phys Chem QM lectures - can be found
&lt;a href=&quot;http://hyperphysics.phy-astr.gsu.edu/hbase/quacon.html#quacon&quot;&gt;here&lt;/a&gt;.
Do take a &lt;a href=&quot;http://hyperphysics.phy-astr.gsu.edu/hbase/quacon.html#quacon&quot;&gt;click&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;On the other hand, if you keep reading, we skip all that historical
guff and get straight into it.&lt;/p&gt;

&lt;h2 id=&quot;the-rules-of-quantum-mechanics&quot;&gt;The Rules of Quantum Mechanics&lt;/h2&gt;

&lt;p&gt;There are only few rules to quantum mechanics.&lt;/p&gt;

&lt;p&gt;But the rules do require some explanation, as you see!&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;
    &lt;p&gt;&lt;strong&gt;The state of a system is described by a wavefunction&lt;/strong&gt;&lt;/p&gt;

    &lt;ul&gt;
      &lt;li&gt;
        &lt;p&gt;The wavefunction is a function of the coordinates of the particles in the
system. It is usually given the symbol \( \psi \)&lt;/p&gt;
      &lt;/li&gt;
      &lt;li&gt;
        &lt;p&gt;\( \psi \) must be continuous i.e. have no “gaps” in it&lt;/p&gt;
      &lt;/li&gt;
      &lt;li&gt;
        &lt;p&gt;The derivative of \( \psi \) must also be continuous i.e. the
wavefunction must be smooth (except at points where the interaction energy
becomes infinite - so called singularities)&lt;/p&gt;
      &lt;/li&gt;
      &lt;li&gt;
        &lt;p&gt;\( \psi \) for bound ie. stable states must be
&lt;a href=&quot;http://hyperphysics.phy-astr.gsu.edu/hbase/quantum/qm.html#c5&quot;&gt;normalizable&lt;/a&gt;
i.e. \( \int |\psi|^2 \) must exist and must equal one; this is called
normalization of the wavefunction. The reason is that \( |\psi(\B{x})|^2 \)
is the probability of finding the particles at given positions \(\B{x}\).&lt;/p&gt;
      &lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;&lt;strong&gt;Any experimental measurement is represented by an operator&lt;/strong&gt;&lt;/p&gt;

    &lt;ul&gt;
      &lt;li&gt;
        &lt;p&gt;An &lt;a href=&quot;http://en.wikipedia.org/wiki/Operator_(physics)#Linear_operators_in_wave_mechanics&quot;&gt;operator&lt;/a&gt;
is a function of the coordinates and momenta of the particles in the
system.&lt;/p&gt;
      &lt;/li&gt;
      &lt;li&gt;
        &lt;p&gt;The momenta (which in classical mechanics is written as \( \B{p} \) and is equal
to mass times velocity \(\B{p} = m\B{v}\)) is in quantum mechanics equal to a derivatives
with respect to the particle coordinates times \( i\hbar \) (where
\( \hbar \) is Planck’s constant divided by \( 2\pi \) )
i.e. in quantum mechanics:&lt;/p&gt;

        &lt;script type=&quot;math/tex; mode=display&quot;&gt;
\boxed{
\hat{p} = -i\hbar \displaystyle\frac{d}{dx} \ \ldots \ \textrm{in 1 dimension}
}
&lt;/script&gt;

        &lt;p&gt;This is very different to classical mechanics!&lt;/p&gt;
      &lt;/li&gt;
      &lt;li&gt;
        &lt;p&gt;Operators are sometimes represented by a symbol with a hat on top e.g. like \( \hat{A} \).
Sometimes we forget the hat if it is clear it is an operator.&lt;/p&gt;
      &lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;&lt;strong&gt;The result of any measurement is an eigenvalue of the operator describing
the experiment, and after the measurement the system is completely described
by the wavefunction corresponding to that eigenvalue&lt;/strong&gt;&lt;/p&gt;

    &lt;ul&gt;
      &lt;li&gt;
        &lt;p&gt;An eigenvalue of an operator \( \hat{A} \) is any real number \( a \) which
obeys an &lt;a href=&quot;http://en.wikipedia.org/wiki/Eigenvalues_and_eigenvectors&quot;&gt;eigenvalue equation&lt;/a&gt;
for that operator i.e. \( \hat{A} \psi = a \psi \).&lt;/p&gt;
      &lt;/li&gt;
      &lt;li&gt;
        &lt;p&gt;An eigenvalue equation is a
&lt;a href=&quot;http://en.wikipedia.org/wiki/Differential_equation&quot;&gt;differential equation&lt;/a&gt;
i.e. an equation involving derivatives. The unknown quantities to be
determined in this equation are the
&lt;a href=&quot;http://en.wikipedia.org/wiki/Wave_function#Position-space_wave_function&quot;&gt;wavefunction&lt;/a&gt;
\( \psi \) and the eigenvalue \( a \).&lt;/p&gt;
      &lt;/li&gt;
      &lt;li&gt;
        &lt;p&gt;Example: The &lt;a href=&quot;&quot;&gt;Schrodinger equation&lt;/a&gt; \( \hat{H}\psi = E\psi \) is just
the eigenvalue equation for the allowed energies \( E \) of the system,
where \( \hat{H} \) is the total energy operator or
&lt;a href=&quot;http://en.wikipedia.org/wiki/Hamiltonian_(quantum_mechanics)#The_Schr.C3.B6dinger_Hamiltonian&quot;&gt;Hamiltonian&lt;/a&gt;
of the system:&lt;/p&gt;

        &lt;script type=&quot;math/tex; mode=display&quot;&gt;
\hat{H} = \underbrace{\sum_i \displaystyle\frac{\hat{p}_i^2}{2 m_i}}_{\twonote{Kinetic energy}{of all particles $i$}}
        + \underbrace{V(\B{x}_1,\B{x}_2,\ldots)}_{\twonote{Potential energy }{of all particles}}
&lt;/script&gt;

        &lt;p&gt;The potential energy \( V \) depends on the positions and perhaps
also the momenta of all the particles. It has to be specified to you for
each problem.&lt;/p&gt;
      &lt;/li&gt;
      &lt;li&gt;
        &lt;p&gt;There may be many solutions to an eigenvalue equation but not all of them
are unacceptable (see Rule 1)&lt;/p&gt;
      &lt;/li&gt;
      &lt;li&gt;
        &lt;p&gt;Since an experiment can yield a many different results, the corresponding
eigenvalue equation for the operator for that experiment also has many
different eigenvalues and solutions. Each eigenvalue \( a \) and its
wavefunction \( \psi \) are paired together.&lt;/p&gt;
      &lt;/li&gt;
      &lt;li&gt;
        &lt;p&gt;QM does not predict exactly &lt;em&gt;which&lt;/em&gt; eigenvalue is obtained from an
experiment; but if \( \psi_i \) is the initial wavefunction before the
experiment \( \hat{A} \) then QM &lt;em&gt;does&lt;/em&gt; predict&lt;/p&gt;

        &lt;ul&gt;
          &lt;li&gt;
            &lt;p&gt;That the &lt;em&gt;probability&lt;/em&gt; of getting result \( a \) with wavefunction
\( \psi_a \) is \( |\int \psi_a^* \psi_i|^2 \)&lt;/p&gt;
          &lt;/li&gt;
          &lt;li&gt;
            &lt;p&gt;That the average of many experimental results is given by the
&lt;a href=&quot;http://hyperphysics.phy-astr.gsu.edu/hbase/quantum/expect.html&quot;&gt;expectation value&lt;/a&gt;
\( \expectation{A} = \int \psi^*_i \hat{A} \psi_i \).&lt;/p&gt;
          &lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ol&gt;

&lt;h2 id=&quot;do-you-get-it-test-yourself&quot;&gt;Do you get it? Test yourself&lt;/h2&gt;

&lt;p&gt;The following are examples of questions that may be asked in the exam.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Q0&lt;/strong&gt;. &lt;em&gt;What are the main differences between classical mechanics and quantum mechanics?&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;&lt;em&gt;Answer&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;In classical mechanics every particle e.g. like an electron, proton, neutron has a
definite position and a velocity. The way the classical particle moves is calculated using
Newton’s Law. On the other hand, in quantum mechanics, particles usually &lt;em&gt;do
not&lt;/em&gt; have a definite position or velocity. That means in quantum mechanics
particles are &lt;em&gt;spread out&lt;/em&gt; and &lt;em&gt;dustributed&lt;/em&gt; in space in some way. We can think
of them as little wiggly waves. Such waves do &lt;em&gt;not&lt;/em&gt; usually have a definite
position. In order to describe the shape of these wiggly waves we need to use a
&lt;em&gt;function&lt;/em&gt; - specifically a &lt;em&gt;wavefunction&lt;/em&gt;. An example might be 
\( \psi(x) = \sin x \). Plotting out this function on a graph shows the
wiggly wave of the quantum particle. The wavefunction describes everything you can 
know about the quantum particle. The Schrodinger equation tells us the shape of the
wavefunction which has a definite energy, for any given potential. Compare this
again to a classical particle which can be descibed by only &lt;em&gt;six numbers&lt;/em&gt; :
three coordinates \(x \) \( y\) and \(z\) and three velocities \(v_x\),
\(v_y\), and \(v_z\). By contrast, a quantum mechanical particle requires
an &lt;em&gt;infinite number of numbers to describe it&lt;/em&gt;. It requires the whole shape of
the wavefunction in the plotted graph to be tabulated for you. Either that
or you have to write a mathematical function such as \( \psi(x) = \sin x \) for 
the wavefunction.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Q1&lt;/strong&gt;. &lt;em&gt;Write down the momentum operator of an electron in one dimension&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;&lt;em&gt;Strategy&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;Use rule 1 of quantum mechanics.&lt;/p&gt;

&lt;p&gt;&lt;em&gt;Answer&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;The momentum operator of an electron in one dimension is
\( \hat{p} = -i\hbar \displaystyle\frac{d}{dx} \).&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Q2&lt;/strong&gt;. &lt;em&gt;Write down the momentum operator of an electron in three dimensions&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;&lt;em&gt;Strategy&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;To do this we have to realize that the momentum in three dimensions is a
vector. So we have to write down a vector with three conponents. Each component
is defined like in A1.&lt;/p&gt;

&lt;p&gt;&lt;em&gt;Answer&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;The momentum operator is given by&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;
\hat{\B{p}} = -i \hbar
\left(
\begin{array}{c}
\partial/\partial x \\
\partial/\partial y \\
\partial/\partial z \\
\end{array}
\right)
&lt;/script&gt;

&lt;p&gt;Note:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;
    &lt;p&gt;A boldface symbol for \( \B{p} \) is used to represent a vector and therefore
a boldface \( \hat{\B{p}} \) is vector of derivative operators, as you can see.&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;The partial derivative symbol \( \partial \) is used whenever there is
more than one variable involved - like in thermodynamics.&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;Note that sometimes the \( x \), \( y \) and \( z \) coordinates
are written as \( r_1 \), \( r_2 \), \( r_3 \)&lt;/p&gt;

    &lt;script type=&quot;math/tex; mode=display&quot;&gt;
\hat{\B{p}} = -i \hbar
\left(
\begin{array}{c}
\partial/\partial r_1 \\
\partial/\partial r_2 \\
\partial/\partial r_3 \\
\end{array}
\right)
&lt;/script&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;Even more briefly we can write &lt;/p&gt;

    &lt;script type=&quot;math/tex; mode=display&quot;&gt; \hat{\B{p}} = -i \hbar \B{\nabla} &lt;/script&gt;

    &lt;p&gt;The upside down triangle is called &lt;a href=&quot;http://en.wikipedia.org/wiki/Del&quot;&gt;nabla&lt;/a&gt; 
and stands for the vector of derivatives in the three directions, as 
already written above.&lt;/p&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;strong&gt;Q3&lt;/strong&gt;. &lt;em&gt;Write down the definition of the angular momentum operator
\( \hat{\B{l}} \) given that the angular momentum is defined by&lt;/em&gt;&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;
\B{l} = \B{r} \times \B{p} =
\left(
\begin{array}{c}
r_2 p_3 - r_3 p_2 \\
r_3 p_1 - r_1 p_3 \\
r_1 p_2 - r_2 p_1
\end{array}
\right).
&lt;/script&gt;

&lt;p&gt;&lt;em&gt;Strategy&lt;/em&gt;.&lt;/p&gt;

&lt;p&gt;Substitute the definition of the 3D momentum operator in (Q2) into the
expression for \( \B{l} \).&lt;/p&gt;

&lt;p&gt;&lt;em&gt;Answer&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;The expression for the angular momentum operator is:&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;
\hat{\B{l}} =
-i\hbar
\left(
\begin{array}{c}
r_2 \pd{}{r_3} - r_3 \pd{}{r_2} \\
r_3 \pd{}{r_1} - r_1 \pd{}{r_3} \\
r_1 \pd{}{r_2} - r_2 \pd{}{r_1}
\end{array}
\right)
&lt;/script&gt;

&lt;p&gt;&lt;strong&gt;Q4&lt;/strong&gt;. &lt;em&gt;Write down the equation which determines the experimental values of
an electron’s momentum in one dimension.&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;&lt;em&gt;Strategy&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;Use Rule 2 of quantum mechanics. Write down the eigenvalue equation
for the momentum operator of the electron.&lt;/p&gt;

&lt;p&gt;&lt;em&gt;Answer&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;The allowed experimental values \( a \) of the electron momentum in one
dimension are determined by solving the following eigenvalue equation:&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;
\underbrace{\left( -i \hbar \frac{d}{dx} \right)}_{\hat{p}_e} \psi(x) = a \psi(x).
&lt;/script&gt;

&lt;p&gt;&lt;strong&gt;Q5&lt;/strong&gt;. &lt;em&gt;Write down the equation which determines the experimental energies of an
electron moving freely in one dimension. Note that the
&lt;a href=&quot;http://en.wikipedia.org/wiki/Kinetic_energy#Newtonian_kinetic_energy&quot;&gt;(kinetic) energy of a free particle&lt;/a&gt;
is given in terms its momentum by the equation \( p^2/2m \) where \( m \)
is the mass of the particle.&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;A5&lt;/strong&gt;.&lt;/p&gt;

&lt;p&gt;&lt;em&gt;Strategy&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;To do this question we need the formula for the energy in terms of the free
electrons position and momentum. Luckily that is given to us. Next we do the
usual substitution for the electron momentum. Then we use Rule 2 and write down
the eigenvalue equation.&lt;/p&gt;

&lt;p&gt;&lt;em&gt;Answer&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;The allowed experimental energies \( E \) are obtained by solving the
following eigenvalue equation,&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;
\hat{H} \psi(x) = E \psi(x).
&lt;/script&gt;

&lt;p&gt;\( \hat{H} \) is the energy operator or &lt;em&gt;Hamiltonian&lt;/em&gt; for the
electron,&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;
\hat{H} = \frac{\hat{p}^2}{2m_e} = -\frac{\hbar^2}{2m_e}\frac{d^2}{dx^2}
&lt;/script&gt;

&lt;p&gt;The right hand side is obtained by substituting \( p = -i\hbar
\displaystyle\frac{d}{dx} \) and \(x \) and \( m_e \) are the position
coordinate and mass of the electron, respectively.&lt;/p&gt;

&lt;p&gt;Note:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;
    &lt;p&gt;To solve this equation to find the allowed energy values
\( E \) means we usually have to first find the unknown wave function
\( \psi(x) \).&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;The Hamiltonian has a negative sign in it. However it’s value  is generally
positive (as energy should be) at any point in space because
\( d^2\psi/dx^2 \) is usually negative; it is generally positive but
not &lt;em&gt;always&lt;/em&gt; positive everywhere.&lt;/p&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;strong&gt;Q6&lt;/strong&gt;. &lt;em&gt;Write down the equation for the allowed energy levels of the hydrogen
atom in one dimension. Assume that \( V(x) \) is given by the &lt;a href=&quot;http://en.wikipedia.org/wiki/Electric_potential_energy#Electrostatic_potential_energy_of_one_point_charge&quot;&gt;electrostatic potential energy&lt;/a&gt;.&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;&lt;em&gt;Strategy&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;We need to write down the total energy of an electron and a proton in one
dimension. The total energy is comprised of the sum of the kinetic energy of
each particle. Hence it depends on the momentum of the electron \( p_e \) and
the momentum of the proton \( p_p \). The total energy also depends of the
electrical attraction between the proton and the electron which depends
on the (inverse) distance between the two particles according to
&lt;a href=&quot;http://en.wikipedia.org/wiki/Electric_potential_energy#Electrostatic_potential_energy_of_one_point_charge&quot;&gt;Coulomb’s Law&lt;/a&gt;
as stated in the problem. The distance between the two particles is
\( |x_p - x_e| \) and involves the coordinates of the electron and the
proton, respectively \( x_e \) and \( x_p \).&lt;/p&gt;

&lt;p&gt;&lt;em&gt;Answer&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;The allowed energies \( E \) for an electron and proton moving in one
dimension are determined by the following eigenvalue equation:&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;
\hat{H} \psi(x_p,x_e) = E \psi(x_p,x_e)
&lt;/script&gt;

&lt;p&gt;where \( \hat{H} \) is the total energy operator or Hamiltonian
for the system, given by&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;% &lt;![CDATA[

\begin{alignat*}{5}
\hat{H} &amp; = \frac{p^2_p}{2m_p}
      &amp; &amp; + \frac{p^2_e}{2m_e}
        &amp; + \frac{1}{4\pi\epsilon_0}\frac{1}{|x_p - x_e|} \\
        &amp; = \underbrace{-\frac{\hbar^2}{2m_p}\frac{d^2}{dx_p^2}}_{\twonote{Kinetic energy}{of proton}} \ \
      &amp; &amp;   \underbrace{-\frac{\hbar^2}{2m_e}\frac{d^2}{dx_e^2}}_{\twonote{Kinetic energy}{of electron}} \ \
        &amp;   \underbrace{-\frac{1}{4\pi\epsilon_0}\frac{1}{|x_p - x_e|}}_{\twonote{Electron-nuclues}{attraction energy}}
        \\
\end{alignat*}
 %]]&gt;&lt;/script&gt;

&lt;p&gt;&lt;strong&gt;Q7&lt;/strong&gt;. &lt;em&gt;Is the equation \( \hat{P}^2 \psi = \hat{P}\psi \) an eigenvalue equation?&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;&lt;em&gt;Strategy&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;Recall the definition of an eigenvalue equation. Compare it to
the above eigenvalue equation to see if they look similar.&lt;/p&gt;

&lt;p&gt;&lt;em&gt;Answer&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;Yes it is an eigenvalue equation! Since, if we set \( \phi = \hat{P}\psi \)
it can be written as \( \hat{P}\phi = \phi = 1\phi \). This is an eigenvalue
equation for \( \phi \) with eigenvalue equal to 1. Note that any old operator
will &lt;em&gt;not&lt;/em&gt; obey such an equation i.e. such an operator \( \hat{P} \) must be
somewhat &lt;em&gt;special&lt;/em&gt; … if it even exists.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Q8&lt;/strong&gt;. &lt;em&gt;Suppose we do an experiment for the total energy \( E_0 \) of a
particle and the wavefunction is \( \psi_0 \) after the experiment.
(i) What is the probability of measuring energy \( E_0 \) again, afterwards?
(ii) What is the probability of measuring a different energy \( E_1 \) afterwards?
(iii) What is the average of many position measurements of the particle?
Assume that the particle is one dimensional.&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;&lt;em&gt;Strategy&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;For (i) refer to the last part of Rule 2 and note the normalization
condition. For (ii), the result depends on (i), see below. For (iii) see the last
part of Rule 2 and use the operator \( x \) for the particle position.&lt;/p&gt;

&lt;p&gt;&lt;em&gt;Answer&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;(i) The probability of obtaining \( E_0 \) again is \( |\int \psi^\ast_0 \psi_0|^2 \).
But this is equal to 1 for a bound state by the normalization condition. So we
would measure \( E_0 \) again the second time with probability 1. This is
interesting. It says that once the first measurement is done the second
measurement keeps the wavefunction in the same state. This is known as
the &lt;a href=&quot;http://en.wikipedia.org/wiki/Quantum_Zeno_effect&quot;&gt;quantum Zeno effect&lt;/a&gt;
and it has been shown experimentally to be true.&lt;/p&gt;

&lt;p&gt;(ii) The probability of getting any other energy is zero since after the first
energy measurement, we always keep getting \( E_0 \). Note: this implies
that \( |\int \psi\sub{0}^\ast(x) \psi_1(x) dx|^2 = 0 \), which can be proved to be true.
The proof is beyond the scope of this course, but relies on the fact that
the eigenvectors are orthogonal.&lt;/p&gt;

&lt;p&gt;(iii) The position of a one dimensional particle is given by( x \).
We could put a “hat” on this to indicate it is an operator but it may
be less confusing to leave it off. So the average of the position measurements
is \( \expectation{x} = \int \psi_0(x)\, x\, \psi_0(x) dx \)&lt;/p&gt;


  
  &lt;p&gt;&lt;a href=&quot;http://localhost:4000/articles/super-quick-summary-of-qm/&quot;&gt;Super quick summary of Quantum Mechanics&lt;/a&gt; was originally published by Dylan Jayatilaka at &lt;a href=&quot;http://localhost:4000&quot;&gt;That Blog by Dylan&lt;/a&gt; on September 20, 2014.&lt;/p&gt;</content>
</entry>


<entry>
  <title type="html"><![CDATA[God or not?]]></title>
  <link rel="alternate" type="text/html" href="http://localhost:4000/articles/god-or-not/"/>
  <id>http://localhost:4000/articles/god-or-not</id>
  <updated>2014-06-07T00:00:00-00:00</updated>
  <published>2014-06-30T00:00:00+08:00</published>
  
  <author>
    <name>Dylan Jayatilaka</name>
    <uri>http://localhost:4000</uri>
    <email>dylan.jayatilaka@gmail.com</email>
  </author>
  <category scheme="http://localhost:4000/tags/#philosophy" term="philosophy" /><category scheme="http://localhost:4000/tags/#god" term="god" /><category scheme="http://localhost:4000/tags/#self" term="self" /><category scheme="http://localhost:4000/tags/#wholism" term="wholism" /><category scheme="http://localhost:4000/tags/#observation" term="observation" />
  <content type="html">
  
    &lt;p&gt;There is a general “waste of time” feeling I get when discussing this topic
with others that I think stems from the notion that agreement will never be
reached.&lt;/p&gt;

&lt;p&gt;That may be so.&lt;/p&gt;

&lt;p&gt;Yet, I think it is worth clarifying the points we &lt;strong&gt;can&lt;/strong&gt; all agree on — and
then arguing from there.&lt;/p&gt;

&lt;p&gt;As a heads-up, I am going to tackle this question by considering what
we ourselves are. After thinking about this, you will hopefully see that
the question is — well — ill defined.&lt;/p&gt;

&lt;p&gt;Let me illustrate what I mean.&lt;/p&gt;

&lt;h2 id=&quot;our-shared-experiences&quot;&gt;Our shared experiences&lt;/h2&gt;

&lt;p&gt;I think many of us can agree that God is not an old gentleman with a beard
floating in the clouds.&lt;/p&gt;

&lt;p&gt;If you think about &lt;em&gt;why&lt;/em&gt; you believe this, you will realize that it is because
of your past experience. You’ve never seen an old man floating in the clouds,
have you? So your conclusion is based on extrapolations from past observations.&lt;/p&gt;

&lt;p&gt;Likewise, some of us may have tried the old “pact with God experiment”. It goes
something like this:&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;God, if you are listening, then if you (do something for me) I
will be forever indebted and (do something for you).&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;This kind of thing generally doesn’t work. The problem is, we simply don’t hear
a voice in our heads that we can converse with. So the conclusion is that God,
if he exists, doesn’t talk back in a straightforward way.&lt;/p&gt;

&lt;p&gt;So, there are some things about God many of us can agree on.&lt;/p&gt;

&lt;h2 id=&quot;gods-nature&quot;&gt;God’s nature&lt;/h2&gt;

&lt;p&gt;What exactly are the characteristics that we would agree our God to have?&lt;/p&gt;

&lt;p&gt;In the Jewish-Christian-Muslim tradition there is only “one” God. Actually,
even though I repeat it, that claim always annoys me because the idea goes
back at least to the Zoroastrians, if not to Pharoah Akhenaten in 1300 BC, or
thereabouts. Put that aside for a moment. Let’s agree to think in this
framework. Clearly the notion of God at least presupposes the notion of “you”
and “him”.&lt;/p&gt;

&lt;p&gt;Therefore, pretty early in the game of talking about God you are faced with the
notion of “other” people or entities.&lt;/p&gt;

&lt;p&gt;And before considering “others” we should think about our “self”.&lt;/p&gt;

&lt;h2 id=&quot;the-dismembered-self&quot;&gt;The dismembered Self&lt;/h2&gt;

&lt;p&gt;“I think, therefore I am” doesn’t get us very far.&lt;/p&gt;

&lt;p&gt;For me, it was much more productive to consider the question:&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;Where is my “self”?&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;The self is obviously not in our hands. We’ve seen others without hands and
we don’t consider their self diminished.&lt;/p&gt;

&lt;p&gt;And we can continue down this ghastly thought-track, chopping off limbs, and
replacing organs by machines, and we realize that the self is somehow embedded
in the head region, the brain. We know it’s true because people with head
injuries often have deep personality changes. The self is localized in the
brain.&lt;/p&gt;

&lt;p&gt;Or is it?&lt;/p&gt;

&lt;h2 id=&quot;the-reconstructed-self&quot;&gt;The reconstructed Self&lt;/h2&gt;

&lt;p&gt;The brain is a large nexus of nerves, chemicals, a memory store. But we
can store memories elsewhere, these days. Photographs. Diaries. Increasingly
in our smart devices. Perhaps in the future these “external” (to the brain)
memories and data will be stored “in the cloud” and we will obtain them with
direct brain links. This would be amazing. Yet, it is not any different to what
we do now when we read our diaries or look at our photographs — we are just
talking about replacing our hands and eyes with other things. It is not a
difference of principle.&lt;/p&gt;

&lt;p&gt;What we are beginning to see here is that while most of the “self”
is localized in the brain, it is very difficult to be sure that &lt;em&gt;all&lt;/em&gt; of
you is really there. At the moment memories are largely stored in the brain,
but not exclusively.&lt;/p&gt;

&lt;p&gt;Carrying this thought forward, we see that when our hands are chopped off we do
indeed lose a part of our “self”.&lt;/p&gt;

&lt;h2 id=&quot;the-other&quot;&gt;The Other&lt;/h2&gt;

&lt;p&gt;Perhaps I’m going too fast, but you must surely have got the idea that your
“self” is not an isolated entity.&lt;/p&gt;

&lt;p&gt;Just to make sure you understand: these words you are reading are a
communication from my “self” to “you”, as if I spoke them, but they are —
where exactly? On Google’s servers? On the screen your reading? In the signals
in your optic nerve? In “your” brain?&lt;/p&gt;

&lt;p&gt;Am I in your brain?&lt;/p&gt;

&lt;p&gt;Well, yes. In a sense. To a certain extent. According to a certain
definition or outlook.&lt;/p&gt;

&lt;p&gt;When does an oyygen molecule become part of “you”? When it is in your mouth?
In your lungs? Crossing the alveoli? Or entering the brain? &lt;/p&gt;

&lt;p&gt;And what if you kiss someone. Does the share oxygen in your joined
respiratory systems mean that — you are joined? &lt;/p&gt;

&lt;p&gt;The point I am making is that you and I are not clearly separate.&lt;/p&gt;

&lt;h2 id=&quot;twins&quot;&gt;Twins&lt;/h2&gt;

&lt;p&gt;Let’s try another example, some other shared experience.&lt;/p&gt;

&lt;p&gt;The case of Siamese twins is interesting.&lt;/p&gt;

&lt;p&gt;Depending on which parts are connected (bodies, heads, brains) they
increasingly become more conjoined in all senses of the word. We see here that
“self” and “other” form a continuous spectrum. But the Siamese twins are an
accident of biology. In the future there seems no reason why we can’t achieve
such joining by non-biological means. Or perhaps by genetic engineering, if the
ethics could ever be sorted out.&lt;/p&gt;

&lt;p&gt;The outcome of these considerations is that “self” and “other” are just
convenient and useful terminologies — for the time being. There is nothing
universal about either. There is no universal individualism. For some reason
(which people like Dawkins claim to explained) it exists to a certain
extent in our world.&lt;/p&gt;

&lt;h2 id=&quot;god-or-not&quot;&gt;God or not?&lt;/h2&gt;

&lt;p&gt;Our conclusion about “wholism” (for want of a better word) has many deep and
fundamental consequences. About morality, justice, the notion of competition,
discrimination.&lt;/p&gt;

&lt;p&gt;Do pause and think about it.&lt;/p&gt;

&lt;p&gt;Coming back to the original question: is there is a God or not?&lt;/p&gt;

&lt;p&gt;One of the consequences of the above argument is that God, if he exists, is not
to be regarded as different from us — in principle. I think the question of
whether God exists is therefore moot. I choose to subscribe to what I understand
to be Spinoza’s view, that God is in fact the totality of what is observed.
That also seems to be the essence of the Bhuddist view.&lt;/p&gt;

&lt;h2 id=&quot;and-you&quot;&gt;And you?&lt;/h2&gt;

&lt;p&gt;The arguments and conclusions drawn here are based on simple observations and
shared experiences that we or others have had. &lt;/p&gt;

&lt;p&gt;Now there are some who do not share such experiences, who do not admit such
experiences as valid. They have their own experiences, thoughts,  which I do
not share, or cannot accept. There are some who make &lt;em&gt;a priori&lt;/em&gt; definitions
about what is and what is not. I do not want to say that these people are
“right” or “wrong”. I only acknowledge that they &lt;em&gt;are&lt;/em&gt;. For them, these
arguments will not apply.&lt;/p&gt;

&lt;p&gt;Did we achieve anything in this discussion? You decide.&lt;/p&gt;


  
  &lt;p&gt;&lt;a href=&quot;http://localhost:4000/articles/god-or-not/&quot;&gt;God or not?&lt;/a&gt; was originally published by Dylan Jayatilaka at &lt;a href=&quot;http://localhost:4000&quot;&gt;That Blog by Dylan&lt;/a&gt; on June 30, 2014.&lt;/p&gt;</content>
</entry>


<entry>
  <title type="html"><![CDATA[Coupled cluster doubles]]></title>
  <link rel="alternate" type="text/html" href="http://localhost:4000/articles/coupled-cluster-doubles/"/>
  <id>http://localhost:4000/articles/coupled-cluster-doubles</id>
  <updated>201-06-07T00:00:00-00:00</updated>
  <published>2014-06-18T00:00:00+08:00</published>
  
  <author>
    <name>Dylan Jayatilaka</name>
    <uri>http://localhost:4000</uri>
    <email>dylan.jayatilaka@gmail.com</email>
  </author>
  <category scheme="http://localhost:4000/tags/#Coupled%20cluster" term="Coupled cluster" /><category scheme="http://localhost:4000/tags/#wavefunction" term="wavefunction" /><category scheme="http://localhost:4000/tags/#doubles%20wavefunction" term="doubles wavefunction" />
  <content type="html">
  
    

  
  &lt;p&gt;&lt;a href=&quot;http://localhost:4000/articles/coupled-cluster-doubles/&quot;&gt;Coupled cluster doubles&lt;/a&gt; was originally published by Dylan Jayatilaka at &lt;a href=&quot;http://localhost:4000&quot;&gt;That Blog by Dylan&lt;/a&gt; on June 18, 2014.&lt;/p&gt;</content>
</entry>


<entry>
  <title type="html"><![CDATA[Coupled cluster singles]]></title>
  <link rel="alternate" type="text/html" href="http://localhost:4000/articles/coupled-cluster-singles/"/>
  <id>http://localhost:4000/articles/coupled-cluster-singles</id>
  <updated>201-06-07T00:00:00-00:00</updated>
  <published>2014-06-17T00:00:00+08:00</published>
  
  <author>
    <name>Dylan Jayatilaka</name>
    <uri>http://localhost:4000</uri>
    <email>dylan.jayatilaka@gmail.com</email>
  </author>
  <category scheme="http://localhost:4000/tags/#Coupled%20cluster" term="Coupled cluster" /><category scheme="http://localhost:4000/tags/#single%20excitation" term="single excitation" /><category scheme="http://localhost:4000/tags/#Hartree-Fock" term="Hartree-Fock" />
  <content type="html">
  
    &lt;p&gt;According to the previous notes the coupled cluster single (CCS) wavefunction 
has the form&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;
\Psi = (\exp T_1) \Phi
     = \exp \left( \sum_I^{N\sub{o}} \sum_A^{N\sub{v}} T_I^A \right) \Phi
&lt;/script&gt;

&lt;p&gt;where the single excitation operator replaces spinorbital \( I \)
in determinant \( \Phi \) (an occupied) with an orbital
\( A \) which does not occur in \( \Phi \) (an unoccupied or virtual
spoinorbital) i.e.&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;
T_I^A \Phi = t_I^A \Phi_I^A.
&lt;/script&gt;

&lt;p&gt;\( t_I^A \) is the amplitude associated with the singly
excited determinant \( \Phi_I^A \).&lt;/p&gt;

&lt;h2 id=&quot;the-ccs-wavefunction-is-just-a-determinent-wavefunction&quot;&gt;The CCS wavefunction is just a determinent wavefunction&lt;/h2&gt;

&lt;p&gt;We can carry out further simplifications to the equations above:&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;% &lt;![CDATA[

\begin{align}
\Psi &amp; = \exp \left( \sum_I^{N\sub{o}} \sum_A^{N\sub{v}} T_I^A \right) \Phi \\
     &amp; = \prod_I  \exp \left( \sum_I T_I^A \right) \Phi \\
     &amp; = \prod_I \left( 1 + T_I^A + \frac{1}{2} (T_I^A)^2 + \ldots \right) \Phi \\
     &amp; = \prod_I \left( 1 + t_I^A \Phi_I^A \right).
\end{align}
 %]]&gt;&lt;/script&gt;

&lt;p&gt;The second and third lines follows from the definition of the exponential function.
The final line follows from the fact that&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;
(T_I^A)^2\Phi = (T_I^A)^3\Phi = \ldots = 0
&lt;/script&gt;

&lt;p&gt;i.e. it is not possible to substitute spinorbital \( I \) more than once in
determinant \( \Phi \).&lt;/p&gt;

&lt;p&gt;In fact, the final line can be written as an unnormalized single determinant
\( \Phi’ \) made from new spinorbitals \( \phi’\sub{I} \) like this,&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;% &lt;![CDATA[

\begin{align}
\Phi’ &amp; = \mathscr{A} \phi’\sub{1}       (\B{x}\sub{1}) \ldots
                      \phi’\sub{N\sub{e}}(\B{x}\sub{N\sub{e}}) \\
\phi’\sub{I}(\B{x}) &amp; = \phi_I(\B{x}) + \sum_A t_I^A \phi_A(\B{x})
\end{align}
 %]]&gt;&lt;/script&gt;

&lt;p&gt;&lt;a href=&quot;http://en.wikipedia.org/wiki/Determinant&quot;&gt;This follows from the column expansion rule for determinants&lt;/a&gt;.
Therefore the \( T_1 \) operator in the coupled cluster wavefunction
causes a mixture of unoccupied spinorbitals into the reference orbitals,&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;
\Psi = (\exp T_1) \Phi = \Phi’.
&lt;/script&gt;

&lt;h2 id=&quot;the-ccs-wavefunction-for-a-hf-reference-has-zero-amplitudes&quot;&gt;The CCS wavefunction for a HF reference has zero amplitudes&lt;/h2&gt;


  
  &lt;p&gt;&lt;a href=&quot;http://localhost:4000/articles/coupled-cluster-singles/&quot;&gt;Coupled cluster singles&lt;/a&gt; was originally published by Dylan Jayatilaka at &lt;a href=&quot;http://localhost:4000&quot;&gt;That Blog by Dylan&lt;/a&gt; on June 17, 2014.&lt;/p&gt;</content>
</entry>


<entry>
  <title type="html"><![CDATA[The coupled cluster wavefunction]]></title>
  <link rel="alternate" type="text/html" href="http://localhost:4000/articles/the-coupled-cluster-wavefunction/"/>
  <id>http://localhost:4000/articles/the-coupled-cluster-wavefunction</id>
  <updated>201-06-07T00:00:00-00:00</updated>
  <published>2014-06-16T00:00:00+08:00</published>
  
  <author>
    <name>Dylan Jayatilaka</name>
    <uri>http://localhost:4000</uri>
    <email>dylan.jayatilaka@gmail.com</email>
  </author>
  <category scheme="http://localhost:4000/tags/#Coupled%20cluster" term="Coupled cluster" /><category scheme="http://localhost:4000/tags/#exponential%20ansatz" term="exponential ansatz" /><category scheme="http://localhost:4000/tags/#size%20extensivity" term="size extensivity" /><category scheme="http://localhost:4000/tags/#separability" term="separability" />
  <content type="html">
  
    &lt;p&gt;The coupled cluster wavefunction provides one of the best general-purpose
approximation schemes for the exact wavefunction.&lt;/p&gt;

&lt;p&gt;The coupled cluster wavefunction in an orthonormal basis has the form&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;% &lt;![CDATA[

\begin{align}
\Psi &amp; = e^{T} \Phi  \\
     &amp; = (1 + T + \textstyle{\frac{1}{2}}T^2 + \textstyle{\frac{1}{6}}T^3 + \ldots) \Phi.
\end{align}
 %]]&gt;&lt;/script&gt;

&lt;p&gt;In the above equation:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;
    &lt;p&gt;\( \Phi \) is called the reference determinant, usually taken to be
the Hartree-Fock determinant.&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;The exponential function is expanded in a power series.&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;The operator \( T = \sum_{n=1}^{N} T_n \) is a sum of excitation operators 
\( T_n \) which for \( n = 1,2,3,\ldots \) successively produce
single, double, triple \( \ldots \) replacements of the “occupied”
spinorbitals in determinant \( \Phi \) with new “unoccupied” or “virtual”
spinorbitals, like this:&lt;/p&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;
T_n \Phi
=
\frac{1}{(n!)^2}
\sum\sub{I\sub{1}\,\ldots\, I\sub{n}}^{N\sub{o}}
\sum\sub{A\sub{1}\,\ldots\, A\sub{n}}^{N\sub{v}}
   t\sub{\, I\sub{1}\,\ldots\, I\sub{n}}^{A\sub{1}\,\ldots\, A\sub{n}}
\Phi\sub{\, I\sub{1}\,\ldots\, I\sub{n}}^{A\sub{1}\,\ldots\, A\sub{n}}
&lt;/script&gt;

&lt;ul&gt;
  &lt;li&gt;
    &lt;p&gt;The quantities \( t\sub{\, I\sub{1}\,\ldots\, I\sub{n}}^{A\sub{1},\ldots,A\sub{n}} \)
are called the cluster amplitudes and are the unknowns to be determined.&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;The operators \( T_1 \), \( T_2 \), \( T_3 \), \(\ldots \) commute with each other.&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;The coupled cluster wavefunction above is exact if an infinite and complete
set of orbitals is used i.e. if \( N_v \) is infinite.&lt;/p&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;coupled-cluster-approximation-schemes&quot;&gt;Coupled cluster approximation schemes&lt;/h2&gt;

&lt;p&gt;An obvious approximation scheme is (apart from using a finite basis set) to limit
the number of excitation operators \( T_n \) used in the expansion of \( T \).&lt;/p&gt;

&lt;p&gt;In this way we get the following approximations:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;
    &lt;p&gt;Coupled cluster singles (CCS) if \( T = T_1 \). &lt;/p&gt;

    &lt;ul&gt;
      &lt;li&gt;
        &lt;p&gt;If the reference \( \Phi \) is taken to be a Hartree-Fock determinant
(either for the ground or excited state) then this yields 
\( t_I^A = 0 \). In other words there is only a trivial solution for the
CCS equations if the Hartree-Fock determinant is the reference. &lt;/p&gt;
      &lt;/li&gt;
      &lt;li&gt;
        &lt;p&gt;If the reference determinant is not the Hartree-Fock solution, the energy
obtained will be higher. (Below I describe how the coefficients are
determined).&lt;/p&gt;
      &lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;Coupled cluster doubles (CCD) if \( T = T_2 \)&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;Coupled cluster singles and doubles (CCSD) if \( T = T_1 + T_2 \)&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;Coupled cluster singles, doubles and triples (CCSDT) if \( T = T_1 + T_2 + T_3 \)&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;Coupled cluster singles, doubles, triples and quadruples (CCSDTQ) if \( T = T_1 + T_2 + T_3 + T_4 \)&lt;/p&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;finding-the-coupled-cluster-energy-and-amplitudes&quot;&gt;Finding the coupled cluster energy and amplitudes&lt;/h2&gt;

&lt;p&gt;To obtain the coupled cluster energy we substitute the corresponding
wavefunction &lt;em&gt;ansatz&lt;/em&gt; into the Schrodinger equation,&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;
H e^T \Phi = E \Phi.
&lt;/script&gt;

&lt;p&gt;Then we project or integrate this equation on the left with successively
different subsituted determinants,&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;% &lt;![CDATA[

\begin{align}
\braket{\Phi}{          H e^T \Phi} &amp; = E \\
\braket{\Phi_I^A}{      H e^T \Phi} &amp; = 0 \\
\braket{\Phi\sub{IJ}^{AB}}{H e^T \Phi} &amp; = 0 \\
\ldots &amp;
\end{align}
 %]]&gt;&lt;/script&gt;

&lt;p&gt;The substituted determinants on the left are called “excited determinants” if
the state \( \Phi \) is the grouds state Hartree-Fock determinant.
The first and higher exictated determinants yield zero on the right hand side
because the determinants with different spin orbitals in them are orthogonal.&lt;/p&gt;

&lt;p&gt;The most important thing to note is that if \( T_n \) is limited to a certain
level of excitations, then we only need to project on the left hand side with
determinants to the same level of excitation. This provides a set of non-linear
equations which determine the amplitude coefficients and the first equation
above provides an equation for the energy \( E \). Thus if we had 
\( T_n = T_2 \) S only the double excited determinant equation above would be
required.&lt;/p&gt;

&lt;p&gt;Of course we have to evaluate the rather complex matrix elements in these
equations before obtaining a set of equations which are actually “programmable”
in terms on integrals, but this is just an (important) technicality. &lt;/p&gt;

&lt;h2 id=&quot;coupled-cluster-transformed-hamiltonian&quot;&gt;Coupled cluster transformed Hamiltonian&lt;/h2&gt;

&lt;p&gt;There is an equivalent way to find the energy and the amplitudes, and it
involves premultiplying the Schrodinger equation by \( e^{-T} \) beforehand,
yeilding the equations&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;% &lt;![CDATA[

\begin{align}
\braket{\Phi}{    e^{-T}H e^T \Phi} &amp; = E \\
\braket{\Phi_I^A}{e^{-T}H e^T \Phi} &amp; = 0 \\
\braket{\Phi\sub{IJ}^{AB}}{e^{-T}H e^T \Phi} &amp; = 0 \\
\ldots &amp;
\end{align}
 %]]&gt;&lt;/script&gt;

&lt;p&gt;It is a rather remarkable fact that the coupled cluster transformed Hamiltonian
\( \tilde{H} = e^{-T}H e^T \Phi \) can be evaluated in closed form. We will
have another post on this rather amazing fact.&lt;/p&gt;

&lt;h2 id=&quot;the-elephant-in-the-room-why-is-an-exponential-function-used&quot;&gt;The elephant in the room: Why is an exponential function used?&lt;/h2&gt;

&lt;figure&gt;
   &lt;img src=&quot;/images/elephant-in-the-room.jpg&quot; /&gt;
&lt;/figure&gt;

&lt;p&gt;The reason is that the energy of the coupled cluster wavefunction separates
into a sum of subsystem energies when those systems are noninteracting i.e.&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;
E[\Psi] = E_A[\Psi_A] + E_B[\Psi_A].
&lt;/script&gt;

&lt;p&gt;This is called &lt;em&gt;size extensivity&lt;/em&gt;. It implies that, for instance, the energy of
\( n \) hydrogen molecules separated by a very large distance from each other
will be equal to \( n \) times the energy of a single hydrogen molecule. This
is clearly a very useful property to have!&lt;/p&gt;

&lt;p&gt;As stated, size extensivity follows from the exponential form of the wavefunction,&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;% &lt;![CDATA[

\begin{align}
\Psi &amp; = e^{T} \Phi \\
     &amp; = e^{T_A+T_B} \Phi \\
     &amp; = e^{T_A}e^{T_B}\Phi
\end{align}
 %]]&gt;&lt;/script&gt;

&lt;p&gt;The final line follows from the fact that the excitation operators
\( T_A \) and \( T_B \) operate on different sets of orbitals –
those from the two separate systems – and so the operators commute.
Now if the Hamiltonian splits into two parts for the subsystems,
\( H = H_A + H_B \) antisymmetrization between the Hartree
orbitals products can be ignored so that \( \Phi \approx \Phi_A\Phi_B \).
This last point is a litlle bit tricky and I should write another post
about it since it brings up interesting points about the
Einstein-Poldolsky-Rosen (EPR) paradox. But if we assume that it holds,
then it implies that&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;% &lt;![CDATA[

\begin{align}
\Psi &amp; = e^{T_A}e^{T_B}\Phi \\
     &amp; \approx e^{T_A}e^{T_B}\Phi_A\Phi_B \\
     &amp; = e^{T_A}\Phi_A e^{T_B}\Phi_B \\
     &amp; = \Psi_A \Psi_B
\end{align}
 %]]&gt;&lt;/script&gt;

&lt;p&gt;The &lt;em&gt;additivity&lt;/em&gt; of the total energy follows from the &lt;em&gt;multiplicative&lt;/em&gt;
factorization of \( \Psi \) above.&lt;/p&gt;

&lt;h2 id=&quot;why-isnt-separability-built-into-qm&quot;&gt;Why isn’t separability built into QM?&lt;/h2&gt;

&lt;p&gt;Since the product form of the wavefunction is so essential to the separability
of the wavefunction, I wonder why this behaviour isn’t in some way “built
into” quantum mechanics from the start? After all, the fermion symmetry is
built into the determinant form of the wavefunction; or equivalently,
in second quantization, this same symmetry is built into the anticommutation
relations of the fermion creation and annihilation operators.&lt;/p&gt;

&lt;p&gt;Perhaps, dear reader, you might like to think about this. Those who are brave
may attempt to the paper by Arponen (1997) PRA 55 pl 2686 where he attempts
to do just that. If you understand it please explain!&lt;/p&gt;


  
  &lt;p&gt;&lt;a href=&quot;http://localhost:4000/articles/the-coupled-cluster-wavefunction/&quot;&gt;The coupled cluster wavefunction&lt;/a&gt; was originally published by Dylan Jayatilaka at &lt;a href=&quot;http://localhost:4000&quot;&gt;That Blog by Dylan&lt;/a&gt; on June 16, 2014.&lt;/p&gt;</content>
</entry>


<entry>
  <title type="html"><![CDATA[Convert a one-electron into a two-electron term]]></title>
  <link rel="alternate" type="text/html" href="http://localhost:4000/articles/convert-a-one-electron-into-two-electron-term/"/>
  <id>http://localhost:4000/articles/convert-a-one-electron-into-two-electron-term</id>
  <updated>201-06-07T00:00:00-00:00</updated>
  <published>2014-06-15T00:00:00+08:00</published>
  
  <author>
    <name>Dylan Jayatilaka</name>
    <uri>http://localhost:4000</uri>
    <email>dylan.jayatilaka@gmail.com</email>
  </author>
  <category scheme="http://localhost:4000/tags/#Matrix%20element" term="Matrix element" /><category scheme="http://localhost:4000/tags/#one-electron%20operator" term="one-electron operator" /><category scheme="http://localhost:4000/tags/#two-electron%20operator" term="two-electron operator" />
  <content type="html">
  
    &lt;p&gt;In quantum chemistry the Hamiltonian is usually split into a
one-electron term and a two-electron term,&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;% &lt;![CDATA[

\begin{align}
H &amp; = h^{(1)} + h^{(2)}
\\
  &amp; = \sum\sub{i=1}^N h(\B{x}\sub{i}) +
  \frac{1}{2}
  \sum\sub{i=1}^N 
  \sum\sub{\stackrel{j=1}{j\neq i}}^N v(\B{x}\sub{i},\B{x}\sub{j})
\end{align}
 %]]&gt;&lt;/script&gt;

&lt;p&gt;It has always seemed to me a bit silly to do this, because the one-electron
term can be converted into a two-electron term by the following trick:&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;
h^{(1)} =
\frac{1}{N}
\sum\sub{i=1}^N \sum\sub{j=1}^N  \left( h(\B{x}\sub{i}) + h(\B{x}\sub{j}) \right).
&lt;/script&gt;

&lt;p&gt;The sum is over all electrons \( N \). Now the one electron term has been
written as a two electron term, and it can be incorporated into the “normal”
two-electron term. The matrix elements of this “converted” one-electron term in
the atomic orbital basis are&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;
(\mu\nu|h^{(1)}|\kappa\lambda) =
  h\sub{\mu\nu} S\sub{\kappa\lambda}
+ S\sub{\mu\nu} h\sub{\kappa\lambda}.
&lt;/script&gt;

&lt;p&gt;Here \( \B{h} \) and \( \B{S} \) are the usual core and overlap matrices,
respectively. It is easy to include them into the normal two electron
integrals, since these matrices are usually be stored in the memory of the
computer.&lt;/p&gt;

&lt;h2 id=&quot;when-is-the-trick-useful&quot;&gt;When is the trick useful?&lt;/h2&gt;

&lt;p&gt;This trick becomes very useful when dealing with correlated methods.
In that case, we need to worry about one-electron matrix elements
at all, which considerably simplifies the equations. Also, the
terms pertaining to “single excitations” in the correlated methods
may effectively be combined with, or derived from, the “double excitations”.
Effectively, the correlated methods only need to worry about double
excitations. &lt;/p&gt;

&lt;p&gt;Pretty cool, huh?&lt;/p&gt;

&lt;h2 id=&quot;caveat&quot;&gt;Caveat&lt;/h2&gt;

&lt;p&gt;Note: this does not help when you want to consider specific subterms
involving single excitations, as in the CCSD(T) theory. In that case,
using this trick, we would obtain these triples corrections as part
of the CCSD(Q) method. In view of the way that the one electron terms
actually “belong” to the two electron terms, perhaps this is actually
a theoretically more satisfactory theory—if not actually more practical.&lt;/p&gt;

  
  &lt;p&gt;&lt;a href=&quot;http://localhost:4000/articles/convert-a-one-electron-into-two-electron-term/&quot;&gt;Convert a one-electron into a two-electron term&lt;/a&gt; was originally published by Dylan Jayatilaka at &lt;a href=&quot;http://localhost:4000&quot;&gt;That Blog by Dylan&lt;/a&gt; on June 15, 2014.&lt;/p&gt;</content>
</entry>


<entry>
  <title type="html"><![CDATA[Determinant matrix elements]]></title>
  <link rel="alternate" type="text/html" href="http://localhost:4000/articles/determinant-matrix-elements/"/>
  <id>http://localhost:4000/articles/determinant-matrix-elements</id>
  <updated>201-06-07T00:00:00-00:00</updated>
  <published>2014-06-14T00:00:00+08:00</published>
  
  <author>
    <name>Dylan Jayatilaka</name>
    <uri>http://localhost:4000</uri>
    <email>dylan.jayatilaka@gmail.com</email>
  </author>
  <category scheme="http://localhost:4000/tags/#Matrix%20element" term="Matrix element" /><category scheme="http://localhost:4000/tags/#determinant" term="determinant" /><category scheme="http://localhost:4000/tags/#one-electron%20operator" term="one-electron operator" /><category scheme="http://localhost:4000/tags/#two-electron%20operator" term="two-electron operator" />
  <content type="html">
  
    &lt;p&gt;In quantum chemistry we often want to do integrals like this:&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;
\braopket{\mathscr{A} \Phi_I}{M}{\mathscr{A} \Phi_J}
=
\int
(\mathscr{A} \Phi_I)^\star  M (\mathscr{A} \Phi_J) \, d\B{x}
&lt;/script&gt;

&lt;p&gt;This integral is generically called a “matrix element”, and specifically
it is a “determinant matrix element”.&lt;/p&gt;

&lt;p&gt;The integration in this matrix element is over electronic coordinates
The functions \( \Phi_K = \phi\sub{k_1}(\B{x_1})\ldots\phi(\B{x}\sub{N}) \)
are Hartree orbital products.
\( M \) is some kind of operator — perhaps a function of one or more of
those coordinates, or derivatives of those coordinates — which importantly
is symmetric in the electron coordinates, since all electrons are indistinguishable.
(Read &lt;a href=&quot;http://dylan-jayatilaka.net/articles/the-determinant-wavefunction&quot;&gt;here&lt;/a&gt;
  and &lt;a href=&quot;http://dylan-jayatilaka.net/articles/the-antisymmetrizer&quot;&gt;here&lt;/a&gt; to know more).&lt;/p&gt;

&lt;p&gt;Now you can see that the determinant matrix element above involves products of
two antisymmetrizers \( \mathscr{A} \). The parentheses make clear that these
antisymmetrizers only “operate” on the electron coordinates in the functions
\( \Phi_K \) immediately to their right.&lt;/p&gt;

&lt;h2 id=&quot;why-are-determinant-matrix-elements-important&quot;&gt;Why are (determinant) matrix elements important?&lt;/h2&gt;

&lt;p&gt;The reason for that matrix elements are important is they allows to
convert a partial differential equation, such as the Schrodinger equation,
into a matrix equation involving numbers. Matrix equations involving
numbers are much easier to solve on computers.&lt;/p&gt;

&lt;p&gt;The reason for that determinant matrix elements are important is that
a determinant is the simplest reasonable model wavefunction for a
group of electrons.&lt;/p&gt;

&lt;p&gt;Clearly, we need to be able to work out or simplify this matrix element
in order to do numerical calculations.&lt;/p&gt;

&lt;h2 id=&quot;matrix-elements-between-determinant-wavefunctions&quot;&gt;Matrix elements between determinant wavefunctions&lt;/h2&gt;

&lt;p&gt;Luckily we can use
&lt;a href=&quot;http://dylan-jayatilaka.net/articles/the-antisymmetrizer&quot;&gt;previous results&lt;/a&gt;
showing that the antisymmetrizeris hermitian, and that a product of two
antisymmetrizers is idempotent i.e.&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;% &lt;![CDATA[

\begin{align}
\braopket{\mathscr{A} \Phi_I}{M}{\mathscr{A} \Phi_J}
= &amp;
\braket{\Phi_I}{\mathscr{A} M \mathscr{A} \Phi_J}
&amp;&amp;
\s{$\mathscr{A}$ is hermitian}
\\
= &amp;
\braket{\Phi_I}{M \mathscr{A}^2 \Phi_J}
&amp;&amp;
\s{$M$ is symmetric}
\\
= &amp;
\sqrt{N!}
\braket{\Phi_I}{M \mathscr{A} \Phi_J}
&amp;&amp;
\s{$\mathscr{A}$ is nearly idempotent}
\\
= &amp;
\int \Phi_I(\B{x})^\star\,{M}\,\left(\sum_u \epsilon_u P_u \Phi_J(\B{x})\right)\,d\B{x}
\end{align}
 %]]&gt;&lt;/script&gt;

&lt;p&gt;To make further progress we need to make certain assumptions about the
operator \( M \).&lt;/p&gt;


  
  &lt;p&gt;&lt;a href=&quot;http://localhost:4000/articles/determinant-matrix-elements/&quot;&gt;Determinant matrix elements&lt;/a&gt; was originally published by Dylan Jayatilaka at &lt;a href=&quot;http://localhost:4000&quot;&gt;That Blog by Dylan&lt;/a&gt; on June 14, 2014.&lt;/p&gt;</content>
</entry>


<entry>
  <title type="html"><![CDATA[The antisymmetrizer]]></title>
  <link rel="alternate" type="text/html" href="http://localhost:4000/articles/the-antisymmetrizer/"/>
  <id>http://localhost:4000/articles/the-antisymmetrizer</id>
  <updated>201-06-07T00:00:00-00:00</updated>
  <published>2014-06-13T00:00:00+08:00</published>
  
  <author>
    <name>Dylan Jayatilaka</name>
    <uri>http://localhost:4000</uri>
    <email>dylan.jayatilaka@gmail.com</email>
  </author>
  <category scheme="http://localhost:4000/tags/#antisymmetrizer" term="antisymmetrizer" /><category scheme="http://localhost:4000/tags/#permutations" term="permutations" /><category scheme="http://localhost:4000/tags/#pauli%20principle" term="pauli principle" /><category scheme="http://localhost:4000/tags/#wavefunction" term="wavefunction" /><category scheme="http://localhost:4000/tags/#determinant" term="determinant" />
  <content type="html">
  
    &lt;p&gt;In this post the  &lt;em&gt;antisymmetrizer operator&lt;/em&gt; is officially defined.&lt;/p&gt;

&lt;p&gt;Those who read the
&lt;a href=&quot;http://dylan-jayatilaka/articles/the-determinant-wavefunction&quot;&gt;determinant wavefunctions post&lt;/a&gt;
will already be familiar with this operator.&lt;/p&gt;

&lt;p&gt;I discuss it again here in order to describe more of it’s properties, which are
important for evaluating many-electron integrals. Such integrals form the
bread-and-butter of quantum chemistry — so knowing about the antisymmetrizer
is important.&lt;/p&gt;

&lt;p&gt;More important for me is that the “antisymmetric” nature of electrons is one of
the puzzling and amazing things about quantum mechanics itself. It’s just so
cool and weird!&lt;/p&gt;

&lt;h2 id=&quot;the-antisymmetrizer&quot;&gt;The antisymmetrizer&lt;/h2&gt;

&lt;p&gt;The antisymmetrizer is so-called because when it is applied to an arbitrary
function of labelled arguments, that function is changed into a new function
which changes sign whenever those arguments are swapped.&lt;/p&gt;

&lt;p&gt;The antisymmetrizer operator is defined by&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;
\mathscr{A}
=
\frac{1}{\sqrt{N!}} \sum_u^{N!} \epsilon_u P_u
&lt;/script&gt;

&lt;p&gt;Notes:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;
    &lt;p&gt;The sum is over all permutations \( u \) of a set of integers
\( { 1, \ldots, N } \).&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;\( P_u \) is an operator which permutes those integer labels in any
expression which follows. For example, \( P_u \) might be the elementary
permutation \( (1 2) \) which swaps labels 1 and 2, although there
may be more complicated permutations such as the cycle \( (1 2 3) \).
See wikpedia &lt;a href=&quot;http://en.wikipedia.org/wiki/Permutation&quot;&gt;here&lt;/a&gt;
for more information.&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;The number of terms in the summation is \( N! \).&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;\( \epsilon_u \) is a number which is either +1 or -1 called the
&lt;em&gt;signature&lt;/em&gt;, &lt;em&gt;sign&lt;/em&gt; or &lt;em&gt;paity&lt;/em&gt; of the permutation \( P_u \). It
is +1 (or -1) if \( P_u \) can be decomposed into a sequence of even
(rrespectively, odd) elementary permutations or &lt;em&gt;swaps&lt;/em&gt; . It is &lt;em&gt;not&lt;/em&gt; at all
obvious that any permutation may be decomposed as either even or odd.
If you are interested, several proofs of this fact are given in
&lt;a href=&quot;http://en.wikipedia.org/wiki/Parity_of_a_permutation&quot;&gt;wikipedia&lt;/a&gt;.
The quantity \( \epsilon_u \) is also called the
&lt;a href=&quot;http://en.wikipedia.org/wiki/Levi-Civita_symbol&quot;&gt;Levi-Civita symbol&lt;/a&gt;
which may be familiar to some of you.&lt;/p&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;making-functions-antisymmetric&quot;&gt;Making functions antisymmetric&lt;/h2&gt;

&lt;p&gt;We have the following theorem:&lt;/p&gt;

&lt;p&gt;The function \( F(\B{x}_1 \ldots \B{x}_n) = \mathscr{A}\, f(\B{x}_1 \ldots \B{x}_n) \)
is antisymmetric, i.e.&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;% &lt;![CDATA[

   F(\ldots \B{x}_j \ldots \B{x}_i \dots)
= -F(\ldots \B{x}_i \ldots \B{x}_j \dots)
\ \ \mbox{for } i&lt;j&lt;N.
 %]]&gt;&lt;/script&gt;

&lt;p&gt;Proof:&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;% &lt;![CDATA[

\begin{align}
F(\ldots, \B{x}_j \ldots \B{x}_i \dots)
= &amp; P_{(i j)} F \\
= &amp; P_{(i j)} \frac{1}{\sqrt{N!}} \sum_u^{N!} \epsilon_u P_u f \\
= &amp; \frac{1}{\sqrt{N!}} \sum_u^{N!} \epsilon_u P_{(i j)} P_u f \\
= &amp; \frac{1}{\sqrt{N!}} \sum_v^{N!} (-\epsilon_u) P_v f \ \ \mbox{where } P_v = P_{(i j)} P_u \\
= &amp; - F
\end{align}
 %]]&gt;&lt;/script&gt;

&lt;p&gt;Remarks: The only tricky part is the penultimate line. There, we used two
facts. First, that the product of two permutations is another permutation 
\( P_v\). This should be obvious, but actually follows from the fact that
permutations form a &lt;a href=&quot;http://en.wikipedia.org/wiki/Group_(mathematics)&quot;&gt;mathematical group&lt;/a&gt;. 
Second, since \( P_v \) has one extra swap compared to \( P_u \) its
signature \( \epsilon_v = -\epsilon_u \).&lt;/p&gt;

&lt;p&gt;We have shown that the antisymmetrizer \( \mathscr{A} \) makes any function
which it is applied to antisymmetric.&lt;/p&gt;

&lt;h2 id=&quot;the-antisymmetrizer-makes-determinant-wavefunctions&quot;&gt;The antisymmetrizer makes determinant wavefunctions&lt;/h2&gt;

&lt;p&gt;If you read the 
&lt;a href=&quot;http://dylan-jayatilaka/articles/the-detereminant-wavefunction&quot;&gt;previous post&lt;/a&gt;
you will see that the antisymmetrizer makes determinant wavefunctions:&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;% &lt;![CDATA[

\mathscr{A}\phi_1(\B{x}_1)\ldots\phi_N(\B{x}_N)
=
\frac{1}{\sqrt{N!}}
\textrm{det}\,
\left|
\begin{array}{lll}
\phi_1(\textrm{x}_1)          &amp; \ldots &amp; \phi_1(\textbf{x}_N) \\
\vdots                        &amp; \ddots &amp; \vdots          \\
\phi_N(\textrm{x}_1) &amp; \ldots &amp; \phi_N(\textrm{x}_N)
\end{array}
\right|.
 %]]&gt;&lt;/script&gt;

&lt;h2 id=&quot;the-antisymmetrizer-is-hermitian&quot;&gt;The antisymmetrizer is Hermitian&lt;/h2&gt;

&lt;p&gt;The antisymmetrizer is Hermitian if \( \mathscr{A}^\dagger = \mathscr{A} \),
which means that for any functions \( \Phi_I \) and \( \Phi_J \)
that these operators are allowed to “act” on we must have&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;
\braket{\Phi_I}{\mathscr{A}^\dagger\, \Phi_J}
\equiv
\braket{\mathscr{A}\, \Phi_I}{\Phi_J}
=
\braket{\Phi_I}{\mathscr{A}\, \Phi_J}.
&lt;/script&gt;

&lt;p&gt;Proof:&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;% &lt;![CDATA[

\begin{align}
\braket{\mathscr{A}\Phi_I}{\Phi_J}
= &amp;
\int
(\mathscr{A} \Phi_I)^* \Phi_J d\B{x}
&amp;&amp; \s{by definition}
\\
= &amp;
\int
(\mathscr{A} \Phi_I^*) \Phi_J d\B{x}
&amp;&amp; \s{$\mathscr{A}$ unaffected by conjugation}
\\
= &amp;
\frac{1}{\sqrt{N!}}
\sum_u^{N!} \epsilon_u
\int
(P_u \Phi_I^*(\B{x})) \Phi_J(\B{x}) d\B{x}
&amp;&amp; \s{ substitute $\mathscr{A}$ definition}
\\
= &amp;
\frac{1}{\sqrt{N!}}
\sum_u^{N!} \epsilon_u
\int
\Phi_I^*(\B{y}) (P_u^{-1} \Phi_J(\B{y}) d\B{y})
&amp;&amp; \s{substitute $\B{y} = P_u \B{x}$}
\\
= &amp;
\frac{1}{\sqrt{N!}}
\sum_u^{N!} \epsilon_u
\int
\Phi_I^* (P_u^{-1} \Phi_J) d\B{y}
&amp;&amp; \s{$d\B{y}= d\B{y}_1 \ldots d\B{y}_N$ is symmetric}
\\
= &amp;
\frac{1}{\sqrt{N!}}
\sum_w^{N!} \epsilon_w
\int
\Phi_I^* (P_w \Phi_J) d\B{y}
&amp;&amp; \s{substiute $P_w=P_u^{-1}$; and $\epsilon_w=\epsilon_u$}
\\
= &amp;
\braket{\Phi_I}{\mathscr{A}\, \Phi_J}
&amp;&amp; \
\end{align}
 %]]&gt;&lt;/script&gt;

&lt;p&gt;Remark: In an \( M \)-dimensional &lt;em&gt;finite&lt;/em&gt; dimensional space
\( V = \mbox{span}\, (\Phi_I ; I=1,\ldots,M) \) the adjoint
\( \mathscr{A}^\dagger \) is also called the “hermitian conjugate”.
In quantum chemistry we usually deal with finite dimensional spaces, so
the terms “self-adjoint” and “hermitian” are equivalent. To be honest
I am no sure of the relevance of infinite dimensional spaces
in any practical calculation.&lt;/p&gt;

&lt;h2 id=&quot;antisymmetrizers-are-nearly-idempotent&quot;&gt;Antisymmetrizers are (nearly) idempotent&lt;/h2&gt;

&lt;p&gt;The following theorem holds:&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;
\mathscr{A}^2 = \sqrt{N!} \mathscr{A}
&lt;/script&gt;

&lt;p&gt;In other words, antisymmetrizing a function which is already antisymmetric
doesn’t change it from being antisymmetric (except for a factor).&lt;/p&gt;

&lt;p&gt;Note: An operators which obeys \( P^2 = P \) is called an &lt;em&gt;idempotent&lt;/em&gt; or
&lt;em&gt;projection&lt;/em&gt; operator. In our case \( (1/\sqrt{N!}) \mathscr{A} \) would be
idempotent.&lt;/p&gt;

&lt;p&gt;Proof:&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;% &lt;![CDATA[

\begin{align}
\mathscr{A}^2
= &amp;
\frac{1}{N!}
(\sum_u^{N!} \epsilon_u P_u)
(\sum_v^{N!} \epsilon_v P_v)
&amp;&amp;
\s{ substitute $\mathscr{A}$ definitions}
\\
= &amp;
\frac{1}{N!}
\sum_u^{N!}
\sum_v^{N!}
(\epsilon_u \epsilon_v) (P_u P_v)
&amp;&amp;
\
\\
= &amp;
\frac{1}{N!}
\sum_u^{N!}
\sum_w^{N!} \epsilon_w P_w
&amp;&amp;
\s{ substitute $P_w = P_u P_v$ for fixed $u$}
\\
= &amp;
\frac{\sqrt{N!}}{N!}
\sum_u^{N!} \mathscr{A}
&amp;&amp;
\
\\
= &amp;
\sqrt{N!} \mathscr{A}
&amp;&amp;
\s{constant sum $u$ gives factor $N!$}
\end{align}
 %]]&gt;&lt;/script&gt;


  
  &lt;p&gt;&lt;a href=&quot;http://localhost:4000/articles/the-antisymmetrizer/&quot;&gt;The antisymmetrizer&lt;/a&gt; was originally published by Dylan Jayatilaka at &lt;a href=&quot;http://localhost:4000&quot;&gt;That Blog by Dylan&lt;/a&gt; on June 13, 2014.&lt;/p&gt;</content>
</entry>


<entry>
  <title type="html"><![CDATA[The determinant wavefunction]]></title>
  <link rel="alternate" type="text/html" href="http://localhost:4000/articles/the-determinant-wavefunction/"/>
  <id>http://localhost:4000/articles/the-determinant-wavefunction</id>
  <updated>201-06-07T00:00:00-00:00</updated>
  <published>2014-06-12T00:00:00+08:00</published>
  
  <author>
    <name>Dylan Jayatilaka</name>
    <uri>http://localhost:4000</uri>
    <email>dylan.jayatilaka@gmail.com</email>
  </author>
  <category scheme="http://localhost:4000/tags/#wavefunction" term="wavefunction" /><category scheme="http://localhost:4000/tags/#determinant" term="determinant" /><category scheme="http://localhost:4000/tags/#Hartree-Fock" term="Hartree-Fock" /><category scheme="http://localhost:4000/tags/#DFT" term="DFT" />
  <content type="html">
  
    &lt;p&gt;This article explains how the Pauli principle evolves naturally to
the idea of a single determinant wavefunction. I don’t explain
or justify the Pauli principle itself! Nevertheless, we start
with it as a reminder.&lt;/p&gt;

&lt;h2 id=&quot;pauli-principle&quot;&gt;Pauli principle&lt;/h2&gt;

&lt;p&gt;The Pauli principle states that when the coordinates of &lt;em&gt;any&lt;/em&gt; pair of electrons
is swapped the sign of the wavefunction is reversed,&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;
 \Psi(\textbf{x}_1 \ldots
      \textbf{x}_i \ldots
      \textbf{x}_j \ldots
      \textbf{x}_N)
=
-\Psi(\textbf{x}_1 \ldots
      \textbf{x}_j \ldots
      \textbf{x}_i \ldots
      \textbf{x}_N)
&lt;/script&gt;

&lt;p&gt;Pauli proved from quantum mechanics that this property holds for &lt;em&gt;any&lt;/em&gt; set of
identical &lt;em&gt;fermions&lt;/em&gt;, and that any particle with half-integer spin is a fermion.
He also showed that those of integer spin were &lt;em&gt;bosons&lt;/em&gt;, and when the coordinates
of identical bosons are swapped, their wavefunction &lt;em&gt;does not&lt;/em&gt; change sign.&lt;/p&gt;

&lt;h2 id=&quot;hartrees-orbital-product-wavefunction&quot;&gt;Hartree’s orbital-product wavefunction&lt;/h2&gt;

&lt;p&gt;The simplest wavefunction we can think of is Hartree’s orbital-product
wavefunction&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;
\Phi(\textbf{x}_1 \ldots
     \textbf{x}_N)
=
\phi_1(\textbf{x}_1) \ldots
\phi_N(\textbf{x}_N)
&lt;/script&gt;

&lt;p&gt;Think of this as wavefunction representing electron 1 in orbital
\( \phi_1 \), electron 2 in orbital \( \phi_2 \), and so on
for all \( N \) particles.
Note: if we swap coordinates \( \textbf{x}_i \) and
\( \textbf{x}_j \) in the above product, it is the same as leaving the
coordinates unchanged but swapping the functions \( \phi_i \) and
\( \phi_j \). So we see that after the swap we we will not have the same
wavefunction — the electrons will be in different orbitals. So the
wavefunction is not the same — let alone obey the Pauli principle where
the wavefunction is supposed to be the same except for sign reversal.&lt;/p&gt;

&lt;p&gt;How can we make a wavefunction which satisfies the Pauli principle?&lt;/p&gt;

&lt;p&gt;Let’s make the problem a bit easier. Suppose we wanted a wavefunction
where swapping electrons led to &lt;em&gt;no&lt;/em&gt; change. How to achieve that?&lt;/p&gt;

&lt;h2 id=&quot;symmetric-orbital-product-wavefunction&quot;&gt;Symmetric orbital-product wavefunction&lt;/h2&gt;

&lt;p&gt;One way is to take any wavefunction, permute the particle coordinates in all
ways, then add all these permuted-coordinate wavefunctions together. We call
this a &lt;strong&gt;symmetrized wavefunction&lt;/strong&gt; because if we swap any pair of coordinates
in this sum it will remain unchanged. It remains the same because in the list
of all permuted wavefunctions a particular term always occurs with a unique
partner where the two coordinates are swapped. We write the symmetrized
wavefunction like this:&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;
\Phi(\textbf{x}_1 \ldots \textbf{x}_{N})
=
\frac{1}{\sqrt{N!}}
\sum_u^{N!} P_u
\phi_1(\textbf{x}_1) \ldots
\phi_N(\textbf{x}_N).
&lt;/script&gt;

&lt;p&gt;The factor \( N! \) is required to ensure the wavefunction is normalized
(assuming the orbitals \( \phi_i \) are normalized also). Incidentally, such
a wavefunction is appropriate to describe a &lt;em&gt;boson&lt;/em&gt; wavefunction which obeys
the Pauli principle for bosons. But we are interested in electrons, which are
fermions, so the wavefunction should change sign. Since the permuted list
contains all terms in pairs, it should be clear to you that for the
wavefunction to change sign every term must be &lt;em&gt;subtracted&lt;/em&gt; from its permuted
partner if we want the wavefunction to change sign. The result is&lt;/p&gt;

&lt;h2 id=&quot;antisymmetric-orbital-product-wavefunction&quot;&gt;Antisymmetric orbital-product wavefunction&lt;/h2&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;
\Phi(\textbf{x}_1\ldots\textbf{x}_{N})
=
\frac{1}{\sqrt{N!}}
\sum_u^{N!} \sigma_u P_u
\phi_1(\textbf{x}_1) \ldots
\phi_N(\textbf{x}_N).
&lt;/script&gt;

&lt;p&gt;The \( \sigma_u \) is either +1 or -1 depending on whether
the permutation \( P_u \) if even or odd. The whole wavefunction
is &lt;strong&gt;antisymmetrized&lt;/strong&gt;.&lt;/p&gt;

&lt;p&gt;Note that &lt;em&gt;any&lt;/em&gt; wavefunction can be symmetrized or antisymmetrized,
not just the Hartree orbital-product wavefunction, as we have done.&lt;/p&gt;

&lt;h2 id=&quot;determinant-wavefunction&quot;&gt;Determinant wavefunction&lt;/h2&gt;

&lt;p&gt;Finally, the antisymmetrized orbital-product wavefunction can be written
in terms of a determinant like this&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;% &lt;![CDATA[

\Psi(\textbf{x}_1\ldots\textbf{x}_{N})
=
\frac{1}{\sqrt{N!}}
\textrm{det}\,
\left|
\begin{array}{lll}
\phi_1(\textrm{x}_1)          &amp; \ldots &amp; \phi_1(\textbf{x}_N) \\
\vdots                        &amp; \ddots &amp; \vdots          \\
\phi_N(\textrm{x}_1) &amp; \ldots &amp; \phi_N(\textrm{x}_N)
\end{array}
\right|.
 %]]&gt;&lt;/script&gt;

&lt;p&gt;This is called a &lt;strong&gt;single determinant wavefunction&lt;/strong&gt;. It forms the basis
of many methods for approximately solving the Schrodinger equation.&lt;/p&gt;


  
  &lt;p&gt;&lt;a href=&quot;http://localhost:4000/articles/the-determinant-wavefunction/&quot;&gt;The determinant wavefunction&lt;/a&gt; was originally published by Dylan Jayatilaka at &lt;a href=&quot;http://localhost:4000&quot;&gt;That Blog by Dylan&lt;/a&gt; on June 12, 2014.&lt;/p&gt;</content>
</entry>


<entry>
  <title type="html"><![CDATA[Write an MP2 program]]></title>
  <link rel="alternate" type="text/html" href="http://localhost:4000/articles/write-an-mp2-program/"/>
  <id>http://localhost:4000/articles/write-an-mp2-program</id>
  <updated>201-06-07T00:00:00-00:00</updated>
  <published>2014-06-11T00:00:00+08:00</published>
  
  <author>
    <name>Dylan Jayatilaka</name>
    <uri>http://localhost:4000</uri>
    <email>dylan.jayatilaka@gmail.com</email>
  </author>
  <category scheme="http://localhost:4000/tags/#programming" term="programming" /><category scheme="http://localhost:4000/tags/#MP2" term="MP2" /><category scheme="http://localhost:4000/tags/#quantum%20chemistry" term="quantum chemistry" /><category scheme="http://localhost:4000/tags/#Foo" term="Foo" />
  <content type="html">
  
    &lt;p&gt;First some theory.&lt;/p&gt;

&lt;p&gt;Well, not theory but the relevant formulas.&lt;/p&gt;

&lt;p&gt;According to Head-Gordon, Pople and Frisch (1988) CPL 153 p. 503 the formula
for the MP2 correlation energy is&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;
E_\textrm{MP2} =
\frac{1}{2}
\sum_{i,j,a,b}
\frac{2(ia|jb)^2 + [(ia|jb)-(ib|ja)]^2}{\epsilon_i + \epsilon_j - \epsilon_a - \epsilon_b}.
&lt;/script&gt;

&lt;p&gt;Here the \( \epsilon_p \) are molecular orbital energies, 
and the indices \( i \) and \( j \) stand for 
occupied molecular orbitals \( \phi_i \) and \( \phi_j \), 
while indices \( a \) and \( b \) stand for unoccupied orbitals
\( \phi_a \) and \( \phi_b \). The two electron integrals are&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;
(pq|rs) = \int \phi_p(1)\phi_q(1) r_{12}^{-1} \phi_r(2) \phi_s(2)
&lt;/script&gt;

&lt;p&gt;These are obtained from the atomic orbital integrals \( (\mu\nu|\kappa\lambda) \)
through a “four index transform”&lt;/p&gt;

&lt;script type=&quot;math/tex; mode=display&quot;&gt;
(pq|rs) = 
\sum_{\mu,\nu,\kappa,\lambda}
          (\mu\nu|\kappa\lambda) c_{\mu p} c_{\nu q} c_{\kappa r} c_{\lambda s}.
&lt;/script&gt;

&lt;p&gt;The coefficients \( \textbf{c} \) are the matrix of the molecular orbital
coefficients in the atomic orbital basis while. It seems we don’t actually need
these if we have the corresponding molecular orbital energies.&lt;/p&gt;

&lt;h2 id=&quot;get-ready&quot;&gt;Get ready&lt;/h2&gt;

&lt;p&gt;To write the program we need to locate where the integrals are. In a
typical program made by scientists there is no “integrated development
environment”. Therefore in unix you would use the &lt;code&gt;grep&lt;/code&gt; command with the
word &lt;code&gt;integral&lt;/code&gt; in the &lt;code&gt;foofiles/&lt;/code&gt; source directory. If you try that you will
get a lot of output. On reflection this is unreasonable: much of quantum
chemistry has to do with integrals. The output can be “pioed”
through the &lt;code&gt;less&lt;/code&gt; pager&lt;/p&gt;

&lt;p&gt;&lt;code&gt;
   cd foofiles
   grep integral | less
&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;After searching you come across the routines &lt;code&gt;.FOCK:make_ERI_integrals(v)&lt;/code&gt;.
Investigating further in the &lt;code&gt;molecule.fock.foo&lt;/code&gt; file we see from the
documentation that this &lt;code&gt;v&lt;/code&gt;  is declared as a a four dimensional array 
&lt;code&gt;v :: MAT4{REAL}&lt;/code&gt; &lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;ruby&quot;&gt;   &lt;span class=&quot;n&quot;&gt;make_MO_ERI_integrals&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;v&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
   &lt;span class=&quot;o&quot;&gt;!&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;Calculate&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;v&amp;quot;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;the&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;electron&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;repulsion&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;integrals&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;no&quot;&gt;ERI&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;the&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;MO&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;basis&lt;/span&gt;
     &lt;span class=&quot;n&quot;&gt;v&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;::&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;MAT4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;no&quot;&gt;REAL&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;},&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;OUT&lt;/span&gt;
     &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Clearly &lt;code&gt;v&lt;/code&gt; holds the two electron electron repulsion integrals (ERIs).
()In a practical program there would be too many of these integrals to
hold in an array, but we do it here just for teaching purposes).&lt;/p&gt;

&lt;h2 id=&quot;housekeeping&quot;&gt;Housekeeping&lt;/h2&gt;

&lt;p&gt;In a perfect world we would expect to call the routine above, just as we
did in the in the “Hello World” program. The routine would simply work and
returned the integrals. If we &lt;em&gt;actually&lt;/em&gt; do that, our program will crash. &lt;/p&gt;

&lt;p&gt;Why?&lt;/p&gt;

&lt;p&gt;Because there is some “set-up” to do. For example, &lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;
    &lt;p&gt;What molecule do we want to treat? &lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;What basis set do to use? &lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;We should do an SCF calculation beforehand for the orbitals and energies!
()If you are reading previous posts, you may recall that the orbital energies
are stored in a variable &lt;code&gt;orbital_energies&lt;/code&gt;).&lt;/p&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;So we want to add our MP2 calculation program to the end of a standard SCF calculation. 
We can find an appropriate input file from the tests/&lt;code&gt; folder. The test job in folder
&lt;/code&gt;h2o_rhf_cc-pVDZ&lt;code&gt; is fine. The &lt;/code&gt;stdin&lt;code&gt; file from this folder can be copied to the
&lt;/code&gt;tonto&lt;code&gt; folder or wherever you want to&lt;/code&gt; run the program.&lt;/p&gt;

&lt;h2 id=&quot;starting-to-write&quot;&gt;Starting to write&lt;/h2&gt;

&lt;p&gt;To write the program it is always good to have a starting template.
Since we actually need to run an SCF calculation beforehand we shouldwe should start by modifying the
&lt;code&gt;run_molecule.exe&lt;/code&gt; program. That, of course is in the &lt;code&gt;run_molecule.foo&lt;/code&gt; file.&lt;/p&gt;

&lt;p&gt;So we start by adding our code to the end of that program. We should probably rename in to
something like &lt;code&gt;run_molecule_mp2.foo&lt;/code&gt; before starting.&lt;/p&gt;

&lt;h2 id=&quot;the-answer&quot;&gt;The Answer&lt;/h2&gt;

&lt;p&gt;At this point I should give you answer. &lt;/p&gt;

&lt;p&gt;But perhaps you can do this as an exercise?&lt;/p&gt;


  
  &lt;p&gt;&lt;a href=&quot;http://localhost:4000/articles/write-an-mp2-program/&quot;&gt;Write an MP2 program&lt;/a&gt; was originally published by Dylan Jayatilaka at &lt;a href=&quot;http://localhost:4000&quot;&gt;That Blog by Dylan&lt;/a&gt; on June 11, 2014.&lt;/p&gt;</content>
</entry>


<entry>
  <title type="html"><![CDATA[Hello World]]></title>
  <link rel="alternate" type="text/html" href="http://localhost:4000/articles/hello-world-program-in-tonto/"/>
  <id>http://localhost:4000/articles/hello-world-program-in-tonto</id>
  <updated>201-06-07T00:00:00-00:00</updated>
  <published>2014-06-10T00:00:00+08:00</published>
  
  <author>
    <name>Dylan Jayatilaka</name>
    <uri>http://localhost:4000</uri>
    <email>dylan.jayatilaka@gmail.com</email>
  </author>
  <category scheme="http://localhost:4000/tags/#hello%20world" term="hello world" /><category scheme="http://localhost:4000/tags/#tonto" term="tonto" /><category scheme="http://localhost:4000/tags/#programming" term="programming" /><category scheme="http://localhost:4000/tags/#basic%20Foo" term="basic Foo" />
  <content type="html">
  
    &lt;p&gt;This is what the “Hello World” program looks like in Tonto&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;ruby&quot;&gt;   &lt;span class=&quot;n&quot;&gt;program&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;run_HELLO_WORLD&lt;/span&gt;

      &lt;span class=&quot;n&quot;&gt;implicit&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;none&lt;/span&gt;

      &lt;span class=&quot;o&quot;&gt;!&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;Macro&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;to&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;create&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;Tonto&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;system&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;object&lt;/span&gt;
      &lt;span class=&quot;o&quot;&gt;!&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;Start&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;MPI&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;parallel&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;stuff&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;too&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;needed&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
      &lt;span class=&quot;no&quot;&gt;TONTO_CREATE&lt;/span&gt;

      &lt;span class=&quot;o&quot;&gt;!&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;Start&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;timer&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;std_time&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;start_timing&lt;/span&gt;

      &lt;span class=&quot;o&quot;&gt;!&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;Initialise&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;standard&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;I&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;O&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;stdout&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;create_stdout&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;stdout&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;open&lt;/span&gt;

      &lt;span class=&quot;o&quot;&gt;!&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;Do&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;it&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;stdout&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;text&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;“&lt;/span&gt;&lt;span class=&quot;no&quot;&gt;Hello&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;World&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;”&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

      &lt;span class=&quot;o&quot;&gt;!&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;Memory&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;report&lt;/span&gt;
      &lt;span class=&quot;no&quot;&gt;TONTO_REPORT&lt;/span&gt;

      &lt;span class=&quot;o&quot;&gt;!&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;Clean&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;up&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;files&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;stdout&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;destroy&lt;/span&gt;

      &lt;span class=&quot;o&quot;&gt;!&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;Clean&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;up&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tonto&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;system&lt;/span&gt;
      &lt;span class=&quot;no&quot;&gt;TONTO_DESTROY&lt;/span&gt;

   &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;To compile the program type &lt;code&gt;make run_hello_world.exe&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;Now, if this seems like a lot of work to print out “Hello World” remember that
the Tonto library is fully self contained: there are no external libraries or
dependencies, there are no hidden operations or code.&lt;/p&gt;

&lt;p&gt;Other points to note:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;
    &lt;p&gt;The program name includes a &lt;code&gt;run_&lt;/code&gt; prefix before the name &lt;code&gt;HELLO_WORLD&lt;/code&gt; all
in capitals. This is requied.&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;Comments appear after an exclamation mark. (Note: The highlighting of code
within comments, and in the code is not always correct because I use the
ruby language highlighter for the moment).&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;There is a lot of “set up”  and “clean up” which occurs, controlled via
macro commands such as &lt;code&gt;TONTO_START&lt;/code&gt; and &lt;code&gt;TONTO_DESTROY&lt;/code&gt; respectively. These
are required.&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;The code uses standard dot notation to pass messages to objects e.g. the
&lt;code&gt;“Hello World”&lt;/code&gt; is passed to the the &lt;code&gt;stdout&lt;/code&gt; textfile object.&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;&lt;code&gt;TONTO_REPORT&lt;/code&gt; produces optional timing, memory use, or call stack
 backtrace — if compiled with special switches.&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;If this seems annoying, remember that Tonto is self-contained
and nothing is hidden or farmed off to libraries.&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;You can explicitly clean-up objects via &lt;code&gt;stdout.destroy&lt;/code&gt; but you don’t
have to. It may help in places where you want high efficiency.&lt;/p&gt;
  &lt;/li&gt;
&lt;/ul&gt;


  
  &lt;p&gt;&lt;a href=&quot;http://localhost:4000/articles/hello-world-program-in-tonto/&quot;&gt;Hello World&lt;/a&gt; was originally published by Dylan Jayatilaka at &lt;a href=&quot;http://localhost:4000&quot;&gt;That Blog by Dylan&lt;/a&gt; on June 10, 2014.&lt;/p&gt;</content>
</entry>


<entry>
  <title type="html"><![CDATA[Science with objects]]></title>
  <link rel="alternate" type="text/html" href="http://localhost:4000/articles/science-with-objects/"/>
  <id>http://localhost:4000/articles/science-with-objects</id>
  <updated>201-06-07T00:00:00-00:00</updated>
  <published>2014-06-09T00:00:00+08:00</published>
  
  <author>
    <name>Dylan Jayatilaka</name>
    <uri>http://localhost:4000</uri>
    <email>dylan.jayatilaka@gmail.com</email>
  </author>
  <category scheme="http://localhost:4000/tags/#objects" term="objects" /><category scheme="http://localhost:4000/tags/#scientific%20programming" term="scientific programming" /><category scheme="http://localhost:4000/tags/#how%20to%20program" term="how to program" /><category scheme="http://localhost:4000/tags/#basic%20Foo" term="basic Foo" />
  <content type="html">
  
    &lt;p&gt;We’d better start with this definition of my own:&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;An object in computer science is a &lt;strong&gt;collection of labeled data&lt;/strong&gt;
together with actions or &lt;strong&gt;methods&lt;/strong&gt; you can perform on that data.
The methods are collected together and defined in one place called a
&lt;strong&gt;class&lt;/strong&gt; or &lt;strong&gt;module&lt;/strong&gt;.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;Sometimes methods are also called messages i.e. you pass messages to the
object to ask it to perform an action. These methods or messages may
involving other objects of different type which may also change. An
object may also be called an abstract data type.&lt;/p&gt;

&lt;h2 id=&quot;dot-notation&quot;&gt;Dot notation&lt;/h2&gt;

&lt;p&gt;Any number may be regarded as an object.&lt;/p&gt;

&lt;p&gt;That’s because a particular number is a datum, and we can perform
actions on it e.g adding or multiplying it by another number. If collect
together these routines we have defined a class.&lt;/p&gt;

&lt;p&gt;The example code snippets below demonstrate a near universal notation,
called “dot notation”, which I illustrate on numbers:&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;ruby&quot;&gt;   &lt;span class=&quot;n&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;b&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;::&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;INT&lt;/span&gt;

   &lt;span class=&quot;n&quot;&gt;a&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;
   &lt;span class=&quot;n&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;plus&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

   &lt;span class=&quot;n&quot;&gt;b&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;
   &lt;span class=&quot;n&quot;&gt;b&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;times&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Here the variable &lt;code&gt;a&lt;/code&gt; is set to &lt;code&gt;1&lt;/code&gt;. &lt;code&gt;a&lt;/code&gt; and &lt;code&gt;b&lt;/code&gt; are integer variables
as seen by the declaration &lt;code&gt;a,b :: INT&lt;/code&gt;.  Then a message is sent to it
via a dot followed by &lt;code&gt;plus(1)&lt;/code&gt;. The intention of the message is that
the value of &lt;code&gt;a&lt;/code&gt; is incremented by the number &lt;code&gt;1&lt;/code&gt;. Presumably the value
of &lt;code&gt;a&lt;/code&gt; is &lt;code&gt;2&lt;/code&gt; after this method is applied. Likewise, the number &lt;code&gt;b&lt;/code&gt; is
set to &lt;code&gt;2&lt;/code&gt; and then the operations &lt;code&gt;times(3)&lt;/code&gt; is performed on it,
resulting in a value of &lt;code&gt;6&lt;/code&gt;. For those of you who like quantum
mechanics, this is nothing other than the application an operator,
except the operator comes &lt;em&gt;after&lt;/em&gt; the entity on which the action is
performed.&lt;/p&gt;

&lt;p&gt;All of this might seem rather trivial. But consider this example:&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;ruby&quot;&gt;   &lt;span class=&quot;n&quot;&gt;m&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;::&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;MAT&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;no&quot;&gt;REAL&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
   &lt;span class=&quot;n&quot;&gt;eigenvalues&lt;/span&gt;  &lt;span class=&quot;o&quot;&gt;::&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;VEC&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;no&quot;&gt;REAL&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
   &lt;span class=&quot;n&quot;&gt;eigenvectors&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;::&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;MAT&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;no&quot;&gt;REAL&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
   &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;j&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;::&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;INT&lt;/span&gt;

   &lt;span class=&quot;k&quot;&gt;do&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;
   &lt;span class=&quot;k&quot;&gt;do&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;j&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;m&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;j&lt;/span&gt;
   &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
   &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;

   &lt;span class=&quot;n&quot;&gt;m&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;solve_eigenproblem&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;eigenvalues&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;eigenvectors&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Look closely.&lt;/p&gt;

&lt;p&gt;It does not require much imagination to guess that &lt;code&gt;m&lt;/code&gt; is a
\(3\times3\) matrix of &lt;code&gt;REAL&lt;/code&gt; numbers, as is &lt;code&gt;eigenvectors&lt;/code&gt;.
&lt;code&gt;eigenvectors&lt;/code&gt; is a 3-dimensional real vector.&lt;/p&gt;

&lt;p&gt;Next come a couple of &lt;code&gt;do&lt;/code&gt; statements. These are a loops. Meaning that
the integer variables &lt;code&gt;i&lt;/code&gt; and &lt;code&gt;j&lt;/code&gt; independently cycle from &lt;code&gt;1&lt;/code&gt; to &lt;code&gt;3&lt;/code&gt;
and the matrix &lt;code&gt;m&lt;/code&gt; is set so its \(i,j\)-th element is &lt;code&gt;i+j&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;The next part is more interesting: a message is sent to to the matrix
&lt;code&gt;m&lt;/code&gt; to please &lt;code&gt;solve_eigenproblem(eigenectors,eigenvalues)&lt;/code&gt;. Again it
does not take much to guess that &lt;code&gt;eigenvalues&lt;/code&gt; are the list of
eigenvalues, while &lt;code&gt;eigenvectors&lt;/code&gt; holds the matrix of eigenvector
coefficients.&lt;/p&gt;

&lt;p&gt;All this is cute, but has anything really been achieved? Isn’t this just
a familiar subroutine call? Well yes. But notice how the object-message
makes it clear what the entity actually being “acted on” is, and what
the inputs or output are.&lt;/p&gt;

&lt;h2 id=&quot;a-leap&quot;&gt;A leap&lt;/h2&gt;

&lt;p&gt;Let me now give a final example which quantum chemists will recognize.
It is slightly changed from the Tonto code base. It is written in the
&lt;code&gt;Foo&lt;/code&gt; language, as are all the above examples. This is a big leap from
the previous examples, but you know enough to unravel it.&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;ruby&quot;&gt;   &lt;span class=&quot;n&quot;&gt;usual_scf&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;recursive&lt;/span&gt;
   &lt;span class=&quot;o&quot;&gt;!&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;Do&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;an&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;SCF&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;calculation&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;The&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;molecular_orbitals&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
   &lt;span class=&quot;o&quot;&gt;!&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;orbital_energies&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;and&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;density_matrix&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;are&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;produced&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;results&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;
      &lt;span class=&quot;nb&quot;&gt;self&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;::&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;MOLECULE&lt;/span&gt;

   &lt;span class=&quot;no&quot;&gt;ENSURE&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;basis_info_made&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;no basis info&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
   &lt;span class=&quot;no&quot;&gt;ENSURE&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;atom&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;created&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;   &lt;span class=&quot;s2&quot;&gt;&amp;quot;no atom list&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
   &lt;span class=&quot;no&quot;&gt;ENSURE&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;scfdata&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;created&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;no scfdata&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

      &lt;span class=&quot;nb&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;initialize_scf&lt;/span&gt;

      &lt;span class=&quot;nb&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;put_scf_banner_and_options&lt;/span&gt;
      &lt;span class=&quot;nb&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;put_scf_table_header&lt;/span&gt;

      &lt;span class=&quot;k&quot;&gt;do&lt;/span&gt;

         &lt;span class=&quot;nb&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;update_molecular_orbitals&lt;/span&gt;
         &lt;span class=&quot;nb&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;make_scf_density_matrix&lt;/span&gt;
         &lt;span class=&quot;nb&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;make_fock_matrix&lt;/span&gt;
         &lt;span class=&quot;nb&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;update_scfdata&lt;/span&gt;
         &lt;span class=&quot;nb&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;update_scfdata_error&lt;/span&gt;
         &lt;span class=&quot;nb&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;put_scf_table_body&lt;/span&gt;

         &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;scfdata&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;scf_done&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;exit&lt;/span&gt;

      &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;

      &lt;span class=&quot;nb&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;put_scf_results&lt;/span&gt;
      &lt;span class=&quot;nb&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cleanup_scf&lt;/span&gt;

   &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Look carefully.&lt;/p&gt;

&lt;p&gt;It is clearly an SCF subroutine called &lt;code&gt;usual_scf&lt;/code&gt; (for those who are
not familiar with quantum chemistry, the SCF procedure is the one which
yeilds the molecular orbitals for a molecule, from which the
Hartree-Fock or density functional theory energy may be calculated). The
declaration indicates that &lt;code&gt;usual_scf&lt;/code&gt; is recursive i.e. it calles itself.&lt;/p&gt;

&lt;p&gt;There are descriptive comments following the routine name, following the
exclamation marks, describing the results. They seem reasonable except
for the do in front of soke of the terms.&lt;/p&gt;

&lt;p&gt;Next, a variable called &lt;code&gt;self&lt;/code&gt; is declared. It is not an integer, or a
real, or matrix as we have seen before, but a &lt;code&gt;MOLECULE&lt;/code&gt;. We don’t know
exactly what this &lt;code&gt;MOLECULE&lt;/code&gt; is, but working by analogy it wpuld seem
reasnable that is is comprised of data — probably quite a lot of data
since a molecule is a compicated object. One might speculate that,
stored in this variable of type &lt;code&gt;MOLECULE&lt;/code&gt; are the types of atoms in it,
and perhaps their positions. Notice that you can work all this out by
intuition and by the naming of the entity. I don’t want to rub it in,
but I did stress the importance of naming things properly in a previous
post.&lt;/p&gt;

&lt;p&gt;What is the actual data that comprises the &lt;code&gt;self&lt;/code&gt; variable of type
&lt;code&gt;MOLECULE&lt;/code&gt;? Where is it defined? We don’t get that information here,
obviously.&lt;/p&gt;

&lt;p&gt;Let me inform you that the type &lt;code&gt;MOLECULE&lt;/code&gt; is defined in the &lt;code&gt;types.foo&lt;/code&gt;
file along with all the other types in the Tonto system.&lt;/p&gt;

&lt;p&gt;Let me also tell you that &lt;code&gt;self&lt;/code&gt; is in fact a &lt;em&gt;hidden argument&lt;/em&gt; to this
routine. In other words, to the routine called &lt;code&gt;usual_scf&lt;/code&gt; requires
&lt;code&gt;self&lt;/code&gt; as an argument. In Fortran it might be called like this in
another part of the library:&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;ruby&quot;&gt;   &lt;span class=&quot;n&quot;&gt;usual_scf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;In actual fact is called like this&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;ruby&quot;&gt;   &lt;span class=&quot;nb&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;usual_scf&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;or even more succinctly like this&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;ruby&quot;&gt;   &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;usual_scf&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Pause on this a moment. I am saying that &lt;code&gt;self&lt;/code&gt; is the object to which the
message &lt;code&gt;usual_scf&lt;/code&gt; is passed to. That is, the SCF calculation is
performed on &lt;code&gt;self&lt;/code&gt; itself. Perhaps this helps to explain the initially
rather cryptic name. In any case, the appearance of a single dot after
an empty space signifies the presence of a hidden &lt;code&gt;self&lt;/code&gt; variable. Apart
from anything this leads to less typing.&lt;/p&gt;

&lt;h2 id=&quot;removing-your-self&quot;&gt;Removing your &lt;code&gt;self&lt;/code&gt;&lt;/h2&gt;

&lt;p&gt;Let’s rewrite the above SCF routine without the unnecessary &lt;code&gt;self.&lt;/code&gt;
prefix.&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;ruby&quot;&gt;   &lt;span class=&quot;n&quot;&gt;usual_scf&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;recursive&lt;/span&gt;
   &lt;span class=&quot;o&quot;&gt;!&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;Do&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;an&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;SCF&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;calculation&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;The&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;molecular_orbitals&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
   &lt;span class=&quot;o&quot;&gt;!&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;orbital_energies&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;and&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;density_matrix&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;are&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;produced&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;results&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;
      &lt;span class=&quot;nb&quot;&gt;self&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;::&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;MOLECULE&lt;/span&gt;

   &lt;span class=&quot;no&quot;&gt;ENSURE&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;basis_info_made&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;no basis info&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
   &lt;span class=&quot;no&quot;&gt;ENSURE&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;atom&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;created&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;   &lt;span class=&quot;s2&quot;&gt;&amp;quot;no atom list&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
   &lt;span class=&quot;no&quot;&gt;ENSURE&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;scfdata&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;created&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;no scfdata&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

      &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;initialize_scf&lt;/span&gt;

      &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;put_scf_banner_and_options&lt;/span&gt;
      &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;put_scf_table_header&lt;/span&gt;

      &lt;span class=&quot;k&quot;&gt;do&lt;/span&gt;

         &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;update_molecular_orbitals&lt;/span&gt;
         &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;make_scf_density_matrix&lt;/span&gt;
         &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;make_fock_matrix&lt;/span&gt;
         &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;update_scfdata&lt;/span&gt;
         &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;update_scfdata_error&lt;/span&gt;
         &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;put_scf_table_body&lt;/span&gt;

         &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;scfdata&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;scf_done&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;exit&lt;/span&gt;

      &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;

      &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;put_scf_results&lt;/span&gt;
      &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cleanup_scf&lt;/span&gt;

   &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Now the routine reads like a dot-point list of things to do. It is
really extremely readable. Indeed, It may seem hard to believe that this
is a working program — perhaps even more unbelievable that this is
essentially just syntactically modified Fortran. (Much of the bad
reputation has come from the style of coding that scientists use: it is
not the language itself these days).&lt;/p&gt;

&lt;p&gt;Furthermore, if we revisit the comments at the start of the routine it
finally becomes clear why the dots appear before &lt;code&gt;.molecular_orbitals&lt;/code&gt;,
&lt;code&gt;.orbital_energies&lt;/code&gt; and &lt;code&gt;.density_matrix&lt;/code&gt;. These are messages passed to
te &lt;code&gt;self&lt;/code&gt; variable to return certain entities. You can guess what they
are. These are in fact part of the data components which comprise the
definition of a &lt;code&gt;MOLECULE&lt;/code&gt;&lt;/p&gt;

&lt;h2 id=&quot;complex-numbers-as-objects&quot;&gt;Complex numbers as objects&lt;/h2&gt;

&lt;p&gt;If you have understood all of this, test yourself with the following
example.&lt;/p&gt;

&lt;p&gt;We are going to define a complex number type, as follows, in the
&lt;code&gt;types.foo&lt;/code&gt; file. (We don’t actually need to do thisbecause complex
numbers are built-in, but this is an exercise)&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;ruby&quot;&gt;&lt;span class=&quot;k&quot;&gt;begin&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;type&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;COMPLEX_NUMBER&lt;/span&gt;

   &lt;span class=&quot;n&quot;&gt;a&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;::&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;REAL&lt;/span&gt;
   &lt;span class=&quot;o&quot;&gt;!&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;The&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;real&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;part&lt;/span&gt;

   &lt;span class=&quot;n&quot;&gt;b&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;::&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;REAL&lt;/span&gt;
   &lt;span class=&quot;o&quot;&gt;!&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;The&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;complex&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;part&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;end&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;type&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Now you know how to define a &lt;strong&gt;derived type&lt;/strong&gt; comprised of built-in
types, in this case two &lt;code&gt;REAL&lt;/code&gt; number types. A derived type may be
comparised of any previously defined derived type or built-in type.&lt;/p&gt;

&lt;p&gt;What is the purpose of the following method? I will tell you that the
rouine is not correct. Can you find the bug?&lt;/p&gt;

&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;ruby&quot;&gt;&lt;span class=&quot;k&quot;&gt;module&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;COMPLEX_NUMBER&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;contains&lt;/span&gt;

   &lt;span class=&quot;n&quot;&gt;to_product_with&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;z2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;result&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;res&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
   &lt;span class=&quot;o&quot;&gt;!&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;What&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;do&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;I&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;do&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;?&lt;/span&gt;

      &lt;span class=&quot;nb&quot;&gt;self&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;::&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;IN&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;z2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;::&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;COMPLEX_NUMBER&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;IN&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;res&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;::&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;COMPLEX_NUMBER&lt;/span&gt;

      &lt;span class=&quot;n&quot;&gt;z_1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;::&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;COMPLEX_NUMBER&lt;/span&gt;

      &lt;span class=&quot;n&quot;&gt;z_1&lt;/span&gt;   &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;self&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;res&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;a&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;z1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;a&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;z2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;a&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;z1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;b&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;z2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;b&lt;/span&gt;
      &lt;span class=&quot;n&quot;&gt;res&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;b&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;z1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;a&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;z2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;b&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;z1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;b&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;z2&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;a&lt;/span&gt;

   &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h2 id=&quot;what-all-the-fuss-is-about&quot;&gt;What all the fuss is about&lt;/h2&gt;

&lt;p&gt;This has been a long post but the key idea is just this:&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;The power of objects is in their organizing ability&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;In particular&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;
    &lt;p&gt;&lt;strong&gt;All methods pertaining to an object are found in the corresponding
module&lt;/strong&gt;. This is helpful because duplication of code is eliminated.
Consider the case of a program written by many contributors &lt;em&gt;not&lt;/em&gt;
written in object oriented way. The chances are that the different
authors write many duplicated routines. In particular domains, much
hard work has been expended to make libraries of, for example, linear
algebra and array routines. However, in other fields this effort is
almost non-existent. Consider the case of quantum chemistry, for
example, with it’s plethora of programs. Consider the wasted and
duplicated efforts of so many smart people!&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;&lt;strong&gt;Organizing programs in an object oriented way facilitates program
evolution&lt;/strong&gt;. Let’s illustrate this again with examples from quantum
chemistry.&lt;/p&gt;

    &lt;ul&gt;
      &lt;li&gt;
        &lt;p&gt;How easy would it be to make use of the &lt;em&gt;integrals&lt;/em&gt; in
this program in another one? Perhaps it isn’t hard if they have
been written to a file … perhaps.&lt;/p&gt;
      &lt;/li&gt;
      &lt;li&gt;
        &lt;p&gt;What if now you wanted to use &lt;em&gt;some&lt;/em&gt; of the integrals and not
others? Perhaps you want to calculate the energy contributions from
a particular region to gain some physical insight?&lt;/p&gt;
      &lt;/li&gt;
      &lt;li&gt;
        &lt;p&gt;What if now you have a new and &lt;em&gt;better way&lt;/em&gt; of calculating the
integrals. Perhaps you have discovered that gaussian basis
functions with complex exponents work much better. How easy would
it be to slot those integras into the code? After all, it would not
be desirable to rewrite *everything in the original program.&lt;/p&gt;
      &lt;/li&gt;
    &lt;/ul&gt;

    &lt;p&gt;In general all of these tasks would be difficult to do unless the
data used was well separated from the other parts of the program,
and all actions on those data are &lt;strong&gt;encapulated&lt;/strong&gt; in one place. But
this is precisely the idea behind the object oriented approach.
Indeed, as we saw, not only are all the methods which act on the same
data collected in the same module — the data object on which the
methods are applied are always the first argument in any routine.&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;&lt;strong&gt;It is easier to maintain an object oriented program&lt;/strong&gt;. If you have
understood the above argument you should be able to provide reasons
for this. As a matter of fact, it is well documented that during the
life cycle of a program &lt;strong&gt;much more effort goes into maintenance and
bug fixing that into the original writing!&lt;/strong&gt; If this is accepted then
it follows that much is gained by using objects.&lt;/p&gt;
  &lt;/li&gt;
&lt;/ol&gt;

&lt;h2 id=&quot;proof-of-the-pudding&quot;&gt;Proof of the pudding&lt;/h2&gt;

&lt;p&gt;The arguments given above may well seem like preaching. Some others may
think that the idea behind object oriented methods is just the concept
of a library — organizing routines acting on the same data in one
place. This is correct: object orientation is just the library concept
on steroids. In a later post I hope to illustrate how easy it is to
write code in a well-designed quantum chemistry package.&lt;/p&gt;


  
  &lt;p&gt;&lt;a href=&quot;http://localhost:4000/articles/science-with-objects/&quot;&gt;Science with objects&lt;/a&gt; was originally published by Dylan Jayatilaka at &lt;a href=&quot;http://localhost:4000&quot;&gt;That Blog by Dylan&lt;/a&gt; on June 09, 2014.&lt;/p&gt;</content>
</entry>


<entry>
  <title type="html"><![CDATA[To program or not]]></title>
  <link rel="alternate" type="text/html" href="http://localhost:4000/articles/to-program-or-not/"/>
  <id>http://localhost:4000/articles/to-program-or-not</id>
  <updated>201-06-07T00:00:00-00:00</updated>
  <published>2014-06-08T00:00:00+08:00</published>
  
  <author>
    <name>Dylan Jayatilaka</name>
    <uri>http://localhost:4000</uri>
    <email>dylan.jayatilaka@gmail.com</email>
  </author>
  <category scheme="http://localhost:4000/tags/#Programming" term="Programming" /><category scheme="http://localhost:4000/tags/#understanding" term="understanding" /><category scheme="http://localhost:4000/tags/#philosophy" term="philosophy" /><category scheme="http://localhost:4000/tags/#naming" term="naming" /><category scheme="http://localhost:4000/tags/#specification" term="specification" /><category scheme="http://localhost:4000/tags/#clarity" term="clarity" /><category scheme="http://localhost:4000/tags/#software%20life%20cycle" term="software life cycle" /><category scheme="http://localhost:4000/tags/#maintenance" term="maintenance" />
  <content type="html">
  
    &lt;p&gt;Doing quantum chemistry or quantum crystallography means doing calculations.&lt;/p&gt;

&lt;p&gt;That leaves you with two choices: 
1. Use some else’s program, or 
2. Write your own.&lt;/p&gt;

&lt;p&gt;Here I argue that you should write your own.&lt;/p&gt;

&lt;h2 id=&quot;why-write-programs&quot;&gt;Why write programs?&lt;/h2&gt;

&lt;p&gt;If you don’t write your own programs, you are obliged to trust that the program
you use is correct. That by itself is not a problem: you may after all only be
interested in the answer, and what that answer can reveal about some other
bigger question.&lt;/p&gt;

&lt;p&gt;But what if something goes wrong? After all, scientific calculations are
usually complex. &lt;/p&gt;

&lt;p&gt;Then it helps to know something about how the methods works — how the program
works — so you can know program limitations and can work around them.&lt;/p&gt;

&lt;p&gt;More importantly, everyone needs to know about how &lt;em&gt;accurate&lt;/em&gt; their calculated
answer is. In this case, knowing &lt;em&gt;something&lt;/em&gt; about the algorithm implementation
is essential — even if you don’t know all the details.&lt;/p&gt;

&lt;h2 id=&quot;understanding&quot;&gt;Understanding&lt;/h2&gt;

&lt;p&gt;So: you are a scientist and you want to write a moderately complex program to
do a quantum chemical calculation. How do you start?&lt;/p&gt;

&lt;p&gt;Let’s assume you have done the obvious and learned to program in a suitable 
language for scientific programming. Fortran, C, Java or python. And let’s
assume you’ve read the books and know the theory. Now what?&lt;/p&gt;

&lt;p&gt;The key step is to &lt;em&gt;understand&lt;/em&gt; what you want to do.&lt;/p&gt;

&lt;p&gt;But what is &lt;strong&gt;understanding&lt;/strong&gt;?&lt;/p&gt;

&lt;p&gt;For me it means:&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;
    &lt;p&gt;&lt;em&gt;Giving meaningful names to things&lt;/em&gt; so that you can refer to
those things by name when explaining things or — in our case — writing
down the algorithms or equations, deriving such equations if necessary. I
won’t pursue this aspect further: that is the province of textbooks. What I
want to talk about here is what is &lt;strong&gt;not&lt;/strong&gt; in the textbooks. So let’s assume
that you have a meaningful set of names, you have these names associated
with some equations which determine your calculation.&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;If the equations are complicated, in order to program them, you need a plan.
You need to structure intermediate results in a way that is both &lt;em&gt;easy to
understand&lt;/em&gt; and &lt;em&gt;efficient to compute&lt;/em&gt;.&lt;/p&gt;
  &lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;Let’s discuss these points in more detail.&lt;/p&gt;

&lt;h2 id=&quot;call-a-spade-a-spadehttpenwikipediaorgwikitocallaspadeaspade&quot;&gt;&lt;a href=&quot;http://en.wikipedia.org/wiki/To_call_a_spade_a_spade&quot;&gt;Call a spade a spade&lt;/a&gt;&lt;/h2&gt;

&lt;p&gt;Naming entities meaningfully is by far the most important and difficult part of
the programming process.&lt;/p&gt;

&lt;p&gt;Your disbelief is audible.&lt;/p&gt;

&lt;p&gt;You say: surely understanding the quantum theory is more difficult?&lt;/p&gt;

&lt;p&gt;I say: that is the &lt;em&gt;same thing&lt;/em&gt;.&lt;/p&gt;

&lt;p&gt;Think about it. &lt;/p&gt;

&lt;p&gt;Naming something properly is the start of how you &lt;em&gt;think&lt;/em&gt; about that thing.
Naming and understanding go together like hand and glove: you simply can’t
think about something clearly unless it is at least named properly. This goes
for quantum theory, programming, and conversation.&lt;/p&gt;

&lt;p&gt;Imagine calling a cup a bowl. Now imagine doing the equivalent when  writing a
programs. Clearly, names are, or should be, even more important in this
context. To wit, imagine calling a heavily used variable &lt;code&gt;v&lt;/code&gt; when it holds the
position coordinate and the velocity by variable &lt;code&gt;x&lt;/code&gt;. Imagine naming a variable
holding the momentum of partice 1 &lt;code&gt;l2&lt;/code&gt;. What a disaster! Yet this is &lt;em&gt;exactly&lt;/em&gt;
what happens in much scientific software.&lt;/p&gt;

&lt;p&gt;If you think I am joking about this just read wikipedia about the 
&lt;a href=&quot;http://en.wikipedia.org/wiki/Software_development_process&quot;&gt;software development process&lt;/a&gt;. 
You will learn that the first step is the “specification”. In fact, it is dogma
in software engineering to “write the documentation first” before doing any
kind of programming. Clearly that dogma is nothing but a formalization of the
naming-thinking process, whereby the unknown objects needed in an algorithm are
formally described in text, and described in sufficient detail to permit code
to be written down. Unfortunately, the writing of documentation &lt;em&gt;before&lt;/em&gt; coding
is rarely undertaken by any scientific programmer.&lt;/p&gt;

&lt;h2 id=&quot;efficiency-versus-clarity&quot;&gt;Efficiency versus clarity&lt;/h2&gt;

&lt;p&gt;Now to the second point.&lt;/p&gt;

&lt;p&gt;Begin with the realization that the objectives of efficiency and clarity are
largely but not completely independent. Generally speaking it &lt;em&gt;is&lt;/em&gt; harder to
write a efficient program in a clear way because it may have to take advantage
of special machine characteristics.&lt;/p&gt;

&lt;p&gt;Of the two characeristics &lt;strong&gt;clarity is much more important&lt;/strong&gt;. That is
because a clear code is easier to understand. Furthermore, a clearly written
code has benefits later down the track, such as:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;
    &lt;p&gt;&lt;strong&gt;Better bug detection and reduced maintenance&lt;/strong&gt;. Perhaps later you will
actually recall and understand what you did.&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;&lt;strong&gt;Better opportunities for optimization and code evolution&lt;/strong&gt; by changing
algorithms. Generally speaking the greatest gains in efficiency occur due to
the use of &lt;em&gt;new algorithms&lt;/em&gt; rather than optimization of the instructions of
computer codes to take advantage of hardware.&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;&lt;strong&gt;Greater chance of collaboration and sharing workload&lt;/strong&gt;, since an unclear
code is unlikely to be adopted as the basis of a future work by you or
anyone else. It is worth keeping in mind the fact that the vast amount of
effort spent on a program occurs in maintenance and code evolution.&lt;/p&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;what-next&quot;&gt;What next?&lt;/h2&gt;

&lt;p&gt;If you are convinced by the above arguments, we should pay attention to best
practice in software engineering. In computer science there are two broad approaches
to creating creating well-structured code:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;
    &lt;p&gt;Object-oriented methods&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;Functional programming methods&lt;/p&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;We would do well to understand the essence of these approaches, but that is for
another time.&lt;/p&gt;


  
  &lt;p&gt;&lt;a href=&quot;http://localhost:4000/articles/to-program-or-not/&quot;&gt;To program or not&lt;/a&gt; was originally published by Dylan Jayatilaka at &lt;a href=&quot;http://localhost:4000&quot;&gt;That Blog by Dylan&lt;/a&gt; on June 08, 2014.&lt;/p&gt;</content>
</entry>


<entry>
  <title type="html"><![CDATA[Quantum theory is wrong]]></title>
  <link rel="alternate" type="text/html" href="http://localhost:4000/articles/quantum-theory-is-wrong/"/>
  <id>http://localhost:4000/articles/quantum-theory-is-wrong</id>
  <updated>2014-06-07T00:00:00-00:00</updated>
  <published>2014-06-07T00:00:00+08:00</published>
  
  <author>
    <name>Dylan Jayatilaka</name>
    <uri>http://localhost:4000</uri>
    <email>dylan.jayatilaka@gmail.com</email>
  </author>
  <category scheme="http://localhost:4000/tags/#quantum%20mechanics" term="quantum mechanics" /><category scheme="http://localhost:4000/tags/#measurement" term="measurement" /><category scheme="http://localhost:4000/tags/#measurement" term="measurement" /><category scheme="http://localhost:4000/tags/#wavefunction" term="wavefunction" /><category scheme="http://localhost:4000/tags/#models" term="models" />
  <content type="html">
  
    &lt;p&gt;I should some words about quantum mechanics to begin with as that topic
will permeate everything from now on.&lt;/p&gt;

&lt;p&gt;Quantum mechanics is held as being inscrutable, and one of the best
theories we have. It is claimed to produce extremely precise and
accurate predictions. And it is true! &lt;/p&gt;

&lt;p&gt;From this, it is tempting to conclude that the story has ended. So what if it
is inscrutable? Surely this is just because it is mathematically complex?
Whoever said the universe had to be simple? Isn’t it enough that it is
&lt;em&gt;predictable&lt;/em&gt;?&lt;/p&gt;

&lt;p&gt;I think that this claim is false: the story of quantum mechanics has not ended.&lt;/p&gt;

&lt;p&gt;In fact, quantum mechanics in its standard form is fundamentally flawed.
In certain circumstances, as you will see, it &lt;em&gt;refuses&lt;/em&gt; to make any predictions
at all!&lt;/p&gt;

&lt;h2 id=&quot;two-theories&quot;&gt;Two theories&lt;/h2&gt;

&lt;p&gt;Quantum mechanics in its standard form is actually two theories. &lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;
    &lt;p&gt;The first part is the Schrodinger mechanics which describes the
system as an evolving correlated many particle wave. Apart from the
fact that a particle either has a momentum or a position, not both,
the correspondence to classical mechanics is clear. &lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;The second part is the infamous postulate which states that
after a measurement the system discontinususly changes from one wave
to another. The latter wave is by definition one of the
normalized eigenstates of the measurement operator; and the
probability that one obtains this state depends on the “overlap” of
the initial and final wave functions.&lt;/p&gt;
  &lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;The second part is nonsense! &lt;/p&gt;

&lt;p&gt;How does the collapse occur? How long does it take? What is the &lt;em&gt;phase&lt;/em&gt; of the
final wave? Is that random as well? Standard quantum mechanics forbids us to even
ask the question!&lt;/p&gt;

&lt;p&gt;In a later post I will explain why quantum mechanics in it’s current
form must be a statistical theory. And in any statistical theory there
is an inherent unexplained component. For example, when one takes
statistics on the heights of people in a population, the reason why
those people actually have a height to be measured is not of interest.
We just collect statistics. Quantum mechanics makes such statistical
predictions as you can see.&lt;/p&gt;

&lt;p&gt;There is a school of thought, the &lt;em&gt;Copenhagen interpretation&lt;/em&gt;, which
argues that this is &lt;em&gt;all&lt;/em&gt; we can ever know. In other words, it is
meaningless to ask what happens during the measurement-collapse event.
This interpretation goes too far.&lt;/p&gt;

&lt;p&gt;Here is why:&lt;/p&gt;

&lt;p&gt;The problem is, the Copenhagen interpretation, when applied to doing
statistics on the heights of people, would encourage us &lt;em&gt;not&lt;/em&gt; enquire
into what height actually is. How did these people &lt;em&gt;become&lt;/em&gt; tall or
short? The Copenhagen interpretation says: “Sorry, I’m only allowed
to tell you the statistical result!”. Now, perhaps in the case of the quantum
world, that may be the case, but is is nevertheless unsatisfactory. &lt;/p&gt;

&lt;p&gt;Besides, if it is meaningless to question what happens during a quantum
measurement event, it must also be equally meaningless to make assertions about
the nature of that event. But the Copenhagen school makes just such an
assertion! Namely: that we are not allowed to question how the collapse-event
occurs. The event is supposed to be &lt;em&gt;incognito&lt;/em&gt;. Clearly then, making such
an assertion is &lt;em&gt;logically&lt;/em&gt; inconsistent by it’s own standards!&lt;/p&gt;

&lt;p&gt;Luckily much progress has been made in investigating these issues. The
theory of &lt;em&gt;quantum decoherence&lt;/em&gt; is currently very fashionable and
compelling. One of it’s champions, Zurek, writes elegantly on the topic
but for my taste, not quite convincingly. On the other hand others such
as Deutch make an equally compelling case for the “many worlds”
interpretation.&lt;/p&gt;

&lt;h2 id=&quot;quantum-chemistry&quot;&gt;Quantum chemistry&lt;/h2&gt;

&lt;p&gt;What has all this to do with quantum chemistry?&lt;/p&gt;

&lt;p&gt;Quite a lot, actually.&lt;/p&gt;

&lt;p&gt;I will give two examples.&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;
    &lt;p&gt;There is a tendency in this field to depend very much on the
statements made by Dirac to the effect that “all of chemistry is now
explained” by quantum mechanics. The arguments above show that this
is clearly false. It may be the case for model systems which are
highly decoupled from their environments. However, it is in chemistry
where systems become large and complex, and it is in precisely these
cases that the notions of system-separability become critical. Not
everything can be regarded usefully as an isolated system. To give
one example, consider the case of electrical conductivity through a
single molecule.&lt;/p&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;p&gt;Second, quantum chemists often emphasis on &lt;em&gt;Hermitian operators&lt;/em&gt;. The
claim is that “all observables must be Hermitian”. Certainly,
Hermitian operators have real eigenvalues, and the results of
measurements should be real. And a Hermitian operator ensures that
the time development of the wavefunction is unitary, leading to a
normalized wave function for all time. However, many measurements are
conveniently described by complex operators. For example, in the
theory of scattering there are situations where particle probability
is not conserved with time — corresponding to particle absorption,
decay, or destruction. There are other experiments in diffraction
where it is convenient if one assumes the &lt;em&gt;phase&lt;/em&gt; as well as the
amplitude of a wave is measured; these experiments too are
conveniently regarded in terms of complex operators.&lt;/p&gt;
  &lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;All this is to indicate to you: always be on guard about grand statements like
“everything is known’’, or “this is exact”. Implicit in these is &lt;em&gt;always&lt;/em&gt; the
model. Always.&lt;/p&gt;

&lt;h2 id=&quot;einsteins-quote&quot;&gt;Einstein’s quote&lt;/h2&gt;

&lt;p&gt;At this point I should present a quite remarkable exchange between Einstein and
Heisenberg, which the latter included in his memoirs. It clearly illustrates
what I have been trying to say. But it will have to wait for another post.&lt;/p&gt;

&lt;h2 id=&quot;the-bright-side&quot;&gt;The bright side&lt;/h2&gt;

&lt;p&gt;I don’t want to give you the wrong impression.&lt;/p&gt;

&lt;p&gt;Quantum mechanics &lt;em&gt;does&lt;/em&gt; produce great results. Hence, it is well worth
developing a feeling for it. If you don’t think that is true, you should keep
reading papers, keep doing your own calculations. The best way is if you do the
work yourself, it becomes much more convincing that way. Hence this blog.&lt;/p&gt;

&lt;p&gt;From my experience, it is really is quite astounding how the mathematics
of quantum mechanics can be used to produce the same numbers that an
experimentalist does: each of us works laboriously on seemingly quite
divergent directions and at the end of the day we invariably get the
same result.&lt;/p&gt;

&lt;p&gt;Now my old supervisor, Handy, used to say&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;Quantum chemistry is the last field where, as the system becomes bigger, you get
reproducible results. &lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;By this he meant that calculations on systems which are any bigger invariably
require statistical mechanical techniques, and these have an intrinsic
irreproducibility due to random random sampling.&lt;/p&gt;

&lt;p&gt;If you accept this, then it follows that quantum chemistry is the last field
where concerns about separability of system and environment can be &lt;em&gt;numerically
probed&lt;/em&gt; and experimentally tested. We invariably get the same result as the
experimentalist, but do we always hae to?&lt;/p&gt;

&lt;p&gt;Are quantum chemists actually looking for cases where the results might differ?
I don’t know. Why don’t you try?&lt;/p&gt;


  
  &lt;p&gt;&lt;a href=&quot;http://localhost:4000/articles/quantum-theory-is-wrong/&quot;&gt;Quantum theory is wrong&lt;/a&gt; was originally published by Dylan Jayatilaka at &lt;a href=&quot;http://localhost:4000&quot;&gt;That Blog by Dylan&lt;/a&gt; on June 07, 2014.&lt;/p&gt;</content>
</entry>


<entry>
  <title type="html"><![CDATA[Big Bang]]></title>
  <link rel="alternate" type="text/html" href="http://localhost:4000/articles/big-bang/"/>
  <id>http://localhost:4000/articles/big-bang</id>
  <updated>2014-06-07T00:00:00-00:00</updated>
  <published>2014-06-07T00:00:00+08:00</published>
  
  <author>
    <name>Dylan Jayatilaka</name>
    <uri>http://localhost:4000</uri>
    <email>dylan.jayatilaka@gmail.com</email>
  </author>
  <category scheme="http://localhost:4000/tags/#musings" term="musings" /><category scheme="http://localhost:4000/tags/#beginnings" term="beginnings" /><category scheme="http://localhost:4000/tags/#big-bang" term="big-bang" />
  <content type="html">
  
    &lt;iframe width=&quot;560&quot; height=&quot;315&quot; src=&quot;http://www.youtube.com/embed/SY0bKE10ZDM&quot; frameborder=&quot;0&quot;&gt; &lt;/iframe&gt;

&lt;p&gt;And so it begins.&lt;/p&gt;

&lt;p&gt;That place to call home.&lt;/p&gt;

&lt;p&gt;Like the universe, this blog has taken time to get where it is. &lt;/p&gt;

&lt;p&gt;I made an abortive attempt to do this once before — with WordPress. It didn’t
work because I was’t clear about what I wanted to say. Also, I didn’t like the
format, the lack of control of my material. With MarkDown I’ve hit the sweet spot.&lt;/p&gt;

&lt;p&gt;So: what &lt;em&gt;is&lt;/em&gt;  going to be in here?&lt;/p&gt;

&lt;p&gt;I want this to be mainly technical — about quantum chemistry,
crystallography, and the computer codes I write to support that work. I want it
to be about the text books, journal articles, and conferences I go to related
to those topics. I daresay some teaching material will creep in.&lt;/p&gt;

&lt;p&gt;I want this to be about the things I know about: the strange things that
are anything but banal.&lt;/p&gt;

&lt;p&gt;Welcome.&lt;/p&gt;

&lt;p&gt;Enjoy your stay.&lt;/p&gt;


  
  &lt;p&gt;&lt;a href=&quot;http://localhost:4000/articles/big-bang/&quot;&gt;Big Bang&lt;/a&gt; was originally published by Dylan Jayatilaka at &lt;a href=&quot;http://localhost:4000&quot;&gt;That Blog by Dylan&lt;/a&gt; on June 07, 2014.&lt;/p&gt;</content>
</entry>

</feed>
